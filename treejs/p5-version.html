<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P5.js 版本 - 创意粒子效果</title>
    <style>
        /**
         * P5.js 版本样式
         * 创意编程实现粒子效果
         */
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
        }

        .info-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            z-index: 100;
        }

        .info-panel h3 {
            margin: 0 0 10px 0;
            color: #64ffda;
        }

        .info-panel ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .info-panel li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>P5.js 粒子效果</h3>
        <p><strong>特点：</strong></p>
        <ul>
            <li>简单易学的 API</li>
            <li>强大的数学函数支持</li>
            <li>适合创意编程</li>
            <li>丰富的绘图功能</li>
        </ul>
        <p><strong>操作：</strong>移动鼠标查看交互效果</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script>
        /**
         * P5.js 螺旋粒子效果实现
         * 使用创意编程方式实现粒子系统
         */

        let particles = [];
        let particleCount = 2000;
        let centerX, centerY;
        let time = 0;

        /**
         * P5.js 初始化函数
         * 设置画布和初始化粒子
         */
        function setup() {
            createCanvas(windowWidth, windowHeight);
            centerX = width / 2;
            centerY = height / 2;
            
            // 初始化粒子
            initializeParticles();
        }

        /**
         * 初始化粒子系统
         * 创建螺旋分布的粒子
         */
        function initializeParticles() {
            particles = [];
            
            for (let i = 0; i < particleCount; i++) {
                const angle = (i / particleCount) * TWO_PI * 8; // 8圈螺旋
                const radius = map(i, 0, particleCount, 20, 200);
                
                const particle = {
                    // 基础位置
                    baseX: cos(angle) * radius,
                    baseY: sin(angle) * radius,
                    
                    // 当前位置
                    x: centerX + cos(angle) * radius,
                    y: centerY + sin(angle) * radius,
                    
                    // 动画参数
                    angle: angle,
                    radius: radius,
                    baseRadius: radius,
                    phase: random(TWO_PI),
                    speed: random(0.01, 0.03),
                    
                    // 视觉属性
                    size: random(1, 4),
                    opacity: random(0.5, 1),
                    
                    // 颜色
                    hue: map(radius, 20, 200, 30, 200), // 从橙色到青色
                    saturation: random(70, 100),
                    brightness: random(80, 100)
                };
                
                particles.push(particle);
            }
        }

        /**
         * P5.js 绘制函数
         * 每帧调用，绘制粒子效果
         */
        function draw() {
            // 清除背景
            background(0, 20); // 带拖尾效果的黑色背景
            
            time += 0.01;
            
            // 绘制中心发光点
            drawCenterGlow();
            
            // 更新和绘制粒子
            updateAndDrawParticles();
            
            // 绘制连线
            drawConnections();
        }

        /**
         * 绘制中心发光点
         * 实现橙色发光核心
         */
        function drawCenterGlow() {
            push();
            translate(centerX, centerY);
            
            // 外层发光
            for (let i = 5; i > 0; i--) {
                const alpha = map(i, 1, 5, 100, 10);
                const size = i * 8 + sin(time * 3) * 5;
                
                fill(255, 100, 0, alpha);
                noStroke();
                ellipse(0, 0, size, size);
            }
            
            // 核心
            fill(255, 150, 0);
            ellipse(0, 0, 8 + sin(time * 5) * 2, 8 + sin(time * 5) * 2);
            
            pop();
        }

        /**
         * 更新和绘制粒子
         * 实现螺旋运动和动态效果
         */
        function updateAndDrawParticles() {
            for (let i = 0; i < particles.length; i++) {
                const p = particles[i];
                
                // 更新角度（螺旋旋转）
                p.angle += p.speed;
                
                // 添加脉冲效果
                const pulse = 1 + sin(time * 2 + p.phase) * 0.3;
                p.radius = p.baseRadius * pulse;
                
                // 计算新位置
                p.x = centerX + cos(p.angle) * p.radius;
                p.y = centerY + sin(p.angle) * p.radius;
                
                // 鼠标交互
                const mouseDistance = dist(mouseX, mouseY, p.x, p.y);
                if (mouseDistance < 100) {
                    const force = map(mouseDistance, 0, 100, 10, 0);
                    const angle = atan2(p.y - mouseY, p.x - mouseX);
                    p.x += cos(angle) * force;
                    p.y += sin(angle) * force;
                }
                
                // 绘制粒子
                push();
                translate(p.x, p.y);
                
                // 动态颜色
                const dynamicHue = p.hue + sin(time + p.phase) * 30;
                colorMode(HSB);
                fill(dynamicHue, p.saturation, p.brightness, p.opacity);
                noStroke();
                
                // 发光效果
                for (let j = 3; j > 0; j--) {
                    const alpha = map(j, 1, 3, p.opacity, p.opacity * 0.3);
                    fill(dynamicHue, p.saturation, p.brightness, alpha);
                    ellipse(0, 0, p.size * j, p.size * j);
                }
                
                pop();
                colorMode(RGB);
            }
        }

        /**
         * 绘制粒子间连线
         * 当粒子距离较近时显示连线
         */
        function drawConnections() {
            stroke(100, 255, 218, 50);
            strokeWeight(0.5);
            
            for (let i = 0; i < particles.length; i += 5) { // 减少计算量
                for (let j = i + 1; j < particles.length; j += 5) {
                    const p1 = particles[i];
                    const p2 = particles[j];
                    const distance = dist(p1.x, p1.y, p2.x, p2.y);
                    
                    if (distance < 80) {
                        const alpha = map(distance, 0, 80, 100, 0);
                        stroke(100, 255, 218, alpha);
                        line(p1.x, p1.y, p2.x, p2.y);
                    }
                }
            }
        }

        /**
         * 窗口大小变化处理
         * 重新调整画布大小和粒子位置
         */
        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            centerX = width / 2;
            centerY = height / 2;
        }

        /**
         * 鼠标点击事件
         * 重新初始化粒子系统
         */
        function mousePressed() {
            initializeParticles();
        }
    </script>
</body>
</html>