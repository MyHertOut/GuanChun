<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶æ·±åº¦è§£æ | å¯è§†åŒ–æ¼”ç¤º</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        line-height: 1.6;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: #333;
        padding: 20px;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        overflow: hidden;
      }

      header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem 2rem;
        text-align: center;
      }

      header h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      header p {
        font-size: 1.2rem;
        opacity: 0.95;
      }

      main {
        padding: 3rem 2rem;
      }

      .section {
        margin-bottom: 4rem;
        padding: 2rem;
        background: #f8fafc;
        border-radius: 12px;
        border-left: 6px solid #667eea;
      }

      h2 {
        color: #667eea;
        font-size: 2.2rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      h3 {
        color: #764ba2;
        font-size: 1.6rem;
        margin-top: 2rem;
        margin-bottom: 1rem;
      }

      .pipeline {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin: 2rem 0;
        padding: 2rem;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .pipeline-step {
        flex: 1;
        min-width: 150px;
        padding: 1.5rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        text-align: center;
        position: relative;
        transition: transform 0.3s, box-shadow 0.3s;
        cursor: pointer;
      }

      .pipeline-step:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
      }

      .pipeline-step::after {
        content: "â†’";
        position: absolute;
        right: -1.5rem;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2rem;
        color: #667eea;
        font-weight: bold;
      }

      .pipeline-step:last-child::after {
        display: none;
      }

      .pipeline-step-number {
        display: inline-block;
        width: 30px;
        height: 30px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        line-height: 30px;
        margin-bottom: 0.5rem;
        font-weight: bold;
      }

      .pipeline-step-title {
        font-weight: bold;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
      }

      .pipeline-step-desc {
        font-size: 0.85rem;
        opacity: 0.9;
      }

      .demo-container {
        margin: 2rem 0;
        padding: 2rem;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .demo-buttons {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 2rem;
      }

      .demo-button {
        padding: 1rem 2rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
      }

      .demo-button.reflow {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .demo-button.repaint {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
      }

      .demo-button.composite {
        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        color: white;
      }

      .demo-button:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .demo-box {
        width: 200px;
        height: 200px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.2rem;
        font-weight: bold;
        margin: 2rem auto;
        transition: all 0.3s;
      }

      .performance-monitor {
        background: #1a202c;
        color: #68d391;
        padding: 2rem;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        margin: 2rem 0;
        max-height: 400px;
        overflow-y: auto;
      }

      .log-entry {
        margin: 0.5rem 0;
        padding: 0.5rem;
        background: rgba(104, 211, 145, 0.1);
        border-left: 3px solid #68d391;
        border-radius: 4px;
      }

      .log-time {
        color: #90cdf4;
        font-weight: bold;
      }

      .log-type-reflow {
        color: #fc8181;
      }

      .log-type-repaint {
        color: #90cdf4;
      }

      .log-type-composite {
        color: #68d391;
      }

      .timeline {
        position: relative;
        padding: 2rem 0;
      }

      .timeline-item {
        position: relative;
        padding-left: 3rem;
        margin-bottom: 2rem;
        border-left: 3px solid #e2e8f0;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        left: -9px;
        top: 0;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        background: #667eea;
        border: 3px solid white;
        box-shadow: 0 0 0 3px #e2e8f0;
      }

      .timeline-content {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .timeline-title {
        color: #667eea;
        font-weight: bold;
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
      }

      .code-block {
        background: #1a202c;
        color: #68d391;
        padding: 1.5rem;
        border-radius: 8px;
        overflow-x: auto;
        margin: 1rem 0;
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
      }

      .highlight-box {
        background: #fff5f5;
        border-left: 4px solid #fc8181;
        padding: 1.5rem;
        margin: 1.5rem 0;
        border-radius: 4px;
      }

      .highlight-box.info {
        background: #ebf8ff;
        border-left-color: #4299e1;
      }

      .highlight-box.success {
        background: #f0fff4;
        border-left-color: #48bb78;
      }

      .comparison-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 2rem 0;
      }

      .comparison-card {
        padding: 2rem;
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }

      .comparison-card:hover {
        transform: translateY(-5px);
      }

      .comparison-card h4 {
        color: #2d3748;
        font-size: 1.3rem;
        margin-bottom: 1rem;
      }

      .comparison-card ul {
        list-style: none;
        padding-left: 0;
      }

      .comparison-card li {
        padding: 0.5rem 0;
        padding-left: 1.5rem;
        position: relative;
      }

      .comparison-card li::before {
        content: "âœ“";
        position: absolute;
        left: 0;
        color: #48bb78;
        font-weight: bold;
      }

      .visual-demo {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin: 2rem 0;
      }

      @media (max-width: 768px) {
        .visual-demo {
          grid-template-columns: 1fr;
        }
      }

      canvas {
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        display: block;
        width: 100%;
        height: auto;
      }

      .interactive-section {
        background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
        padding: 2rem;
        border-radius: 12px;
        margin: 2rem 0;
      }

      .fps-counter {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.8);
        color: #68d391;
        padding: 1rem;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        font-size: 1.2rem;
        z-index: 1000;
        min-width: 150px;
      }

      .fps-value {
        font-size: 2rem;
        font-weight: bold;
        color: #48bb78;
      }
    </style>
  </head>

  <body>
    <div class="fps-counter" id="fpsCounter">
      <div>FPS: <span class="fps-value" id="fpsValue">60</span></div>
      <div style="font-size: 0.8rem; margin-top: 0.5rem">å®æ—¶å¸§ç‡ç›‘æµ‹</div>
    </div>

    <div class="container">
      <header>
        <h1>ğŸš€ æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶æ·±åº¦è§£æ</h1>
        <p>ä» HTML åˆ°åƒç´ ï¼šå®Œæ•´çš„æ¸²æŸ“æµç¨‹å¯è§†åŒ–æ¼”ç¤º</p>
      </header>

      <main>
        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šè§£ææµç¨‹ -->
        <section class="section">
          <h2>ğŸ“– ç¬¬ä¸€é˜¶æ®µï¼šHTML è§£ææµç¨‹</h2>
          <p>å½“æµè§ˆå™¨æ¥æ”¶åˆ° HTML æ–‡æ¡£æ—¶ï¼Œä¼šç»å†ä»¥ä¸‹è½¬æ¢è¿‡ç¨‹ï¼š</p>

          <div class="timeline">
            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">1. å­—èŠ‚æµ (Bytes)</div>
                <p>
                  æµè§ˆå™¨é€šè¿‡ç½‘ç»œæ¥æ”¶ HTML
                  æ–‡ä»¶çš„åŸå§‹å­—èŠ‚æ•°æ®ã€‚è¿™äº›æ•°æ®é€šå¸¸ä»¥æ•°æ®åŒ…çš„å½¢å¼åˆ†å—åˆ°è¾¾ï¼Œæµè§ˆå™¨ä¼šç«‹å³å¼€å§‹å¤„ç†è¿™äº›æ•°æ®ï¼Œè€Œä¸ä¼šç­‰å¾…æ•´ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæˆã€‚
                </p>
                <div class="code-block">
                  3C 68 74 6D 6C 3E 3C 68 65 61 64 3E ...
                </div>
              </div>
            </div>

            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">2. å­—ç¬¦è½¬æ¢ (Characters)</div>
                <p>
                  æ ¹æ® HTTP å“åº”å¤´ä¸­çš„ Content-Type (å¦‚ charset=UTF-8)
                  æˆ–æ–‡ä»¶æœ¬èº«çš„ BOM
                  æ ‡è®°ï¼Œå°†å­—èŠ‚æµè½¬æ¢ä¸ºäººç±»å¯è¯»çš„å­—ç¬¦ã€‚å¦‚æœæœªæŒ‡å®šç¼–ç ï¼Œæµè§ˆå™¨ä¼šè¿›è¡Œ"å­—ç¬¦é›†å—…æ¢"ã€‚
                </p>
                <div class="code-block">
                  &lt;html&gt;&lt;head&gt;&lt;title&gt;...
                </div>
              </div>
            </div>

            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">3. ä»¤ç‰ŒåŒ– (Tokenization)</div>
                <p>
                  å°†å­—ç¬¦æµè½¬æ¢ä¸º HTML
                  æ ‡å‡†å®šä¹‰çš„ä»¤ç‰Œï¼ˆTokensï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªçŠ¶æ€æœºè¿‡ç¨‹ï¼Œè§£æå™¨åœ¨"æ ‡ç­¾æ‰“å¼€"ã€"æ ‡ç­¾åç§°"ã€"å±æ€§åç§°"ç­‰çŠ¶æ€é—´åˆ‡æ¢ã€‚
                </p>
                <div class="code-block">
                  StartTag: html<br />
                  StartTag: head<br />
                  StartTag: title<br />
                  Characters: "é¡µé¢æ ‡é¢˜"<br />
                  EndTag: title
                </div>
                <div class="highlight-box info">
                  <strong>ğŸ’¡ å…³é”®ç‚¹ï¼š</strong>è¿™ä¸ªè¿‡ç¨‹ç”± HTML
                  è§£æå™¨ï¼ˆTokenizerï¼‰å®Œæˆï¼Œéµå¾ª WHATWG HTML è§„èŒƒã€‚å³ä½¿ HTML
                  æœ‰é”™è¯¯ï¼ˆå¦‚ç¼ºå°‘é—­åˆæ ‡ç­¾ï¼‰ï¼Œè§£æå™¨ä¹Ÿä¼šå°è¯•ä¿®å¤ã€‚
                </div>
              </div>
            </div>

            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">
                  4. DOM æ ‘æ„å»º (DOM Tree Construction)
                </div>
                <p>
                  å°†ä»¤ç‰Œè½¬æ¢ä¸º DOM èŠ‚ç‚¹ï¼Œå¹¶æ„å»º DOM
                  æ ‘ç»“æ„ã€‚æ­¤è¿‡ç¨‹ä¼šå—åˆ°é˜»å¡èµ„æºï¼ˆå¦‚åŒæ­¥è„šæœ¬ï¼‰çš„å½±å“ï¼Œè§£æå™¨é‡åˆ°
                  &lt;script&gt; æ—¶ä¼šæš‚åœæ„å»ºï¼Œç›´åˆ°è„šæœ¬æ‰§è¡Œå®Œæ¯•ã€‚
                </p>
                <div class="code-block">
                  Document<br />
                  â””â”€ html<br />
                  &nbsp;&nbsp;&nbsp;â”œâ”€ head<br />
                  &nbsp;&nbsp;&nbsp;â”‚&nbsp;&nbsp;â””â”€ title<br />
                  &nbsp;&nbsp;&nbsp;â”‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â””â”€ #text:
                  "é¡µé¢æ ‡é¢˜"<br />
                  &nbsp;&nbsp;&nbsp;â””â”€ body<br />
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â””â”€ div<br />
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â””â”€
                  #text: "å†…å®¹"
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šå…³é”®æ¸²æŸ“è·¯å¾„ -->
        <section class="section">
          <h2>âš¡ ç¬¬äºŒé˜¶æ®µï¼šå…³é”®æ¸²æŸ“è·¯å¾„ (Critical Rendering Path)</h2>
          <p>
            DOM
            æ ‘æ„å»ºå®Œæˆåï¼Œæµè§ˆå™¨éœ€è¦å°†å…¶è½¬æ¢ä¸ºå±å¹•ä¸Šçš„åƒç´ ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå…³é”®æ¸²æŸ“è·¯å¾„ã€‚
          </p>

          <div class="highlight-box info" style="margin-bottom: 2rem">
            <strong>ğŸ—ï¸ ç°ä»£æµè§ˆå™¨çš„å¤šè¿›ç¨‹æ¶æ„ï¼š</strong><br />
            ç°ä»£æµè§ˆå™¨ï¼ˆå¦‚ Chromeï¼‰é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼Œç¡®ä¿ç¨³å®šæ€§å’Œå®‰å…¨æ€§ï¼š<br /><br />
            â€¢
            <strong>æµè§ˆå™¨è¿›ç¨‹ (Browser Process)</strong
            >ï¼šç®¡ç†ç•Œé¢ã€ç½‘ç»œã€å­˜å‚¨<br />
            â€¢
            <strong>æ¸²æŸ“è¿›ç¨‹ (Renderer Process)</strong
            >ï¼šæ¯ä¸ªæ ‡ç­¾é¡µä¸€ä¸ªï¼Œè´Ÿè´£æ¸²æŸ“<br />
            &nbsp;&nbsp;â”œâ”€ <strong>ä¸»çº¿ç¨‹ (Main Thread)</strong>ï¼šæ‰§è¡Œ JSã€DOM
            è§£æã€Layoutã€Paint<br />
            &nbsp;&nbsp;â”œâ”€
            <strong>åˆæˆçº¿ç¨‹ (Compositor Thread)</strong>ï¼šå¤„ç†å›¾å±‚åˆæˆ<br />
            &nbsp;&nbsp;â””â”€
            <strong>å…‰æ …çº¿ç¨‹ (Raster Thread)</strong>ï¼šå°†å›¾å±‚è½¬æ¢ä¸ºä½å›¾<br />
            â€¢ <strong>GPU è¿›ç¨‹</strong>ï¼šç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶<br />
            â€¢ <strong>æ’ä»¶è¿›ç¨‹</strong>ï¼šæ²™ç®±éš”ç¦»æ’ä»¶
          </div>

          <div class="pipeline">
            <div class="pipeline-step" onclick="showStepDetail('dom')">
              <div class="pipeline-step-number">1</div>
              <div class="pipeline-step-title">DOM</div>
              <div class="pipeline-step-desc">æ–‡æ¡£å¯¹è±¡æ¨¡å‹</div>
            </div>

            <div class="pipeline-step" onclick="showStepDetail('cssom')">
              <div class="pipeline-step-number">2</div>
              <div class="pipeline-step-title">CSSOM</div>
              <div class="pipeline-step-desc">CSS å¯¹è±¡æ¨¡å‹</div>
            </div>

            <div class="pipeline-step" onclick="showStepDetail('render')">
              <div class="pipeline-step-number">3</div>
              <div class="pipeline-step-title">Render Tree</div>
              <div class="pipeline-step-desc">æ¸²æŸ“æ ‘</div>
            </div>

            <div class="pipeline-step" onclick="showStepDetail('layout')">
              <div class="pipeline-step-number">4</div>
              <div class="pipeline-step-title">Layout</div>
              <div class="pipeline-step-desc">å¸ƒå±€/å›æµ</div>
            </div>

            <div class="pipeline-step" onclick="showStepDetail('paint')">
              <div class="pipeline-step-number">5</div>
              <div class="pipeline-step-title">Paint</div>
              <div class="pipeline-step-desc">ç»˜åˆ¶</div>
            </div>

            <div class="pipeline-step" onclick="showStepDetail('composite')">
              <div class="pipeline-step-number">6</div>
              <div class="pipeline-step-title">Composite</div>
              <div class="pipeline-step-desc">åˆæˆ</div>
            </div>
          </div>

          <div id="stepDetail" class="demo-container" style="display: none">
            <h3 id="stepTitle"></h3>
            <div id="stepContent"></div>
          </div>
        </section>

        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ€§èƒ½å¯¹æ¯” -->
        <section class="section">
          <h2>âš–ï¸ ç¬¬ä¸‰é˜¶æ®µï¼šReflow vs Repaint vs Composite</h2>
          <p>
            ä¸åŒçš„ CSS
            å±æ€§ä¿®æ”¹ä¼šè§¦å‘ä¸åŒç¨‹åº¦çš„é‡æ–°æ¸²æŸ“ï¼Œæ€§èƒ½å·®å¼‚å·¨å¤§ã€‚ç†è§£æµè§ˆå™¨çº¿ç¨‹æ¨¡å‹æ˜¯ä¼˜åŒ–çš„å…³é”®ã€‚
          </p>

          <div class="comparison-grid">
            <div class="comparison-card" style="border-top: 5px solid #fc8181">
              <h4>ğŸ”´ Reflow (å›æµ/é‡æ’)</h4>
              <p><strong>æ€§èƒ½å½±å“ï¼š</strong>æœ€æ˜‚è´µ ğŸ’¥</p>
              <p><strong>æ¶‰åŠçº¿ç¨‹ï¼š</strong>ä¸»çº¿ç¨‹ (Main Thread)</p>
              <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
              <ul>
                <li>æ”¹å˜å°ºå¯¸ï¼ˆwidth, heightï¼‰</li>
                <li>æ”¹å˜ä½ç½®ï¼ˆleft, top, marginï¼‰</li>
                <li>æ·»åŠ /åˆ é™¤ DOM å…ƒç´ </li>
                <li>æ”¹å˜å­—ä½“å¤§å°</li>
                <li>çª—å£å¤§å°æ”¹å˜</li>
              </ul>
              <div class="highlight-box">
                <strong>âš ï¸ å±é™©ï¼š</strong
                >æµè§ˆå™¨å¿…é¡»é‡æ–°è®¡ç®—å¸ƒå±€ï¼ˆLayoutï¼‰ï¼Œè¿™ä¼šé˜»å¡ä¸»çº¿ç¨‹ä¸Šçš„ JS
                æ‰§è¡Œã€‚å¦‚æœå¸ƒå±€å¤æ‚ï¼Œä¼šå¯¼è‡´ä¸¥é‡çš„æ‰å¸§ã€‚
              </div>
            </div>

            <div class="comparison-card" style="border-top: 5px solid #4299e1">
              <h4>ğŸ”µ Repaint (é‡ç»˜)</h4>
              <p><strong>æ€§èƒ½å½±å“ï¼š</strong>ä¸­ç­‰ âš¡</p>
              <p><strong>æ¶‰åŠçº¿ç¨‹ï¼š</strong>ä¸»çº¿ç¨‹ (Main Thread)</p>
              <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
              <ul>
                <li>æ”¹å˜é¢œè‰²ï¼ˆcolor, background-colorï¼‰</li>
                <li>æ”¹å˜è¾¹æ¡†é¢œè‰²</li>
                <li>æ”¹å˜é€æ˜åº¦ (éåˆæˆå±‚)</li>
                <li>æ”¹å˜é˜´å½±</li>
                <li>æ”¹å˜è½®å»“</li>
              </ul>
              <div class="highlight-box info">
                <strong>â„¹ï¸ è¯´æ˜ï¼š</strong>è·³è¿‡äº† Layout
                é˜¶æ®µï¼Œä½†ä»éœ€åœ¨ä¸»çº¿ç¨‹è¿›è¡Œæ …æ ¼åŒ–ï¼ˆPaintï¼‰ã€‚è™½ç„¶æ¯” Reflow
                å¿«ï¼Œä½†é¢‘ç¹é‡ç»˜ä»ä¼šå ç”¨ CPUã€‚
              </div>
            </div>

            <div class="comparison-card" style="border-top: 5px solid #48bb78">
              <h4>ğŸŸ¢ Composite (åˆæˆ)</h4>
              <p><strong>æ€§èƒ½å½±å“ï¼š</strong>æœ€ä¼˜ ğŸš€</p>
              <p>
                <strong>æ¶‰åŠçº¿ç¨‹ï¼š</strong>åˆæˆçº¿ç¨‹ (Compositor Thread) + GPU
              </p>
              <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
              <ul>
                <li>transformï¼ˆå¹³ç§»ã€ç¼©æ”¾ã€æ—‹è½¬ï¼‰</li>
                <li>opacity (é…åˆåˆæˆå±‚)</li>
                <li>filter</li>
                <li>will-change</li>
              </ul>
              <div class="highlight-box success">
                <strong>âœ… æœ€ä½³å®è·µï¼š</strong>è¿™äº›å±æ€§å®Œå…¨ç»•è¿‡ä¸»çº¿ç¨‹ï¼Œç›´æ¥åœ¨ GPU
                ä¸Šå¤„ç†ã€‚å³ä½¿ä¸»çº¿ç¨‹è¢«ç¹é‡çš„ JS ä»»åŠ¡é˜»å¡ï¼ŒåŠ¨ç”»ä¾ç„¶æµç•…ï¼
              </div>
            </div>
          </div>
        </section>

        <!-- ç¬¬å››éƒ¨åˆ†ï¼šäº¤äº’å¼æ¼”ç¤º -->
        <section class="section">
          <h2>ğŸ® ç¬¬å››é˜¶æ®µï¼šäº¤äº’å¼æ€§èƒ½æ¼”ç¤º</h2>
          <p>
            ç‚¹å‡»æŒ‰é’®è§‚å¯Ÿä¸åŒæ“ä½œå¯¹æ¸²æŸ“æ€§èƒ½çš„å½±å“ï¼Œå¹¶åœ¨æ§åˆ¶å°å’Œæ€§èƒ½ç›‘è§†å™¨ä¸­æŸ¥çœ‹å®æ—¶æ•°æ®ã€‚
          </p>

          <div class="interactive-section">
            <div class="demo-buttons">
              <button class="demo-button reflow" onclick="triggerReflow()">
                è§¦å‘ Reflow (æ”¹å˜å°ºå¯¸)
              </button>
              <button class="demo-button repaint" onclick="triggerRepaint()">
                è§¦å‘ Repaint (æ”¹å˜é¢œè‰²)
              </button>
              <button
                class="demo-button composite"
                onclick="triggerComposite()"
              >
                è§¦å‘ Composite (transform)
              </button>
              <button
                class="demo-button"
                style="background: #718096; color: white"
                onclick="clearLogs()"
              >
                æ¸…ç©ºæ—¥å¿—
              </button>
            </div>

            <div class="demo-box" id="demoBox">æ¼”ç¤ºç›’å­</div>

            <div class="performance-monitor" id="performanceMonitor">
              <div class="log-entry">
                <span class="log-time">[ç³»ç»Ÿ]</span>
                æ€§èƒ½ç›‘è§†å™¨å·²å¯åŠ¨ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æŸ¥çœ‹ä¸åŒæ“ä½œçš„æ€§èƒ½å½±å“...
              </div>
            </div>
          </div>
        </section>

        <!-- ç¬¬äº”éƒ¨åˆ†ï¼šå®é™…æµ‹é‡ -->
        <section class="section">
          <h2>ğŸ“Š ç¬¬äº”é˜¶æ®µï¼šæ€§èƒ½æµ‹é‡ API</h2>
          <p>
            ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ Performance API å¯ä»¥ç²¾ç¡®æµ‹é‡æ¸²æŸ“æ€§èƒ½ã€‚æŒæ¡è¿™äº› API
            æ˜¯æ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚
          </p>

          <h3>1. Navigation Timing API</h3>
          <p style="line-height: 1.8; margin-bottom: 1rem">
            Navigation Timing API
            æä¾›äº†é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„ç²¾ç¡®æ—¶é—´æˆ³ï¼Œå¸®åŠ©æˆ‘ä»¬å®šä½æ€§èƒ½ç“¶é¢ˆã€‚
          </p>

          <div class="code-block">
            // æµ‹é‡å…³é”®æ¸²æŸ“è·¯å¾„æ—¶é—´<br />
            window.addEventListener('load', () => {<br />
            &nbsp;&nbsp;const perfData = performance.timing;<br />
            &nbsp;&nbsp;const nav = performance.navigation;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” DNS æŸ¥è¯¢æ—¶é—´<br />
            &nbsp;&nbsp;const dnsTime = perfData.domainLookupEnd -
            perfData.domainLookupStart;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” TCP è¿æ¥æ—¶é—´<br />
            &nbsp;&nbsp;const tcpTime = perfData.connectEnd -
            perfData.connectStart;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” è¯·æ±‚å“åº”æ—¶é—´ (TTFB - Time To First Byte)<br />
            &nbsp;&nbsp;const ttfb = perfData.responseStart -
            perfData.requestStart;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” å†…å®¹ä¸‹è½½æ—¶é—´<br />
            &nbsp;&nbsp;const downloadTime = perfData.responseEnd -
            perfData.responseStart;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” DOM è§£ææ—¶é—´ (å…³é”®ï¼)<br />
            &nbsp;&nbsp;const domParse = perfData.domInteractive -
            perfData.domLoading;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” èµ„æºåŠ è½½æ—¶é—´<br />
            &nbsp;&nbsp;const resourceLoad = perfData.loadEventStart -
            perfData.domContentLoadedEventEnd;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;// ğŸ” å®Œæ•´é¡µé¢åŠ è½½æ—¶é—´<br />
            &nbsp;&nbsp;const pageLoad = perfData.loadEventEnd -
            perfData.navigationStart;<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;console.group('â±ï¸ é¡µé¢åŠ è½½æ€§èƒ½åˆ†æ');<br />
            &nbsp;&nbsp;console.log(`DNS æŸ¥è¯¢: ${dnsTime}ms`);<br />
            &nbsp;&nbsp;console.log(`TCP è¿æ¥: ${tcpTime}ms`);<br />
            &nbsp;&nbsp;console.log(`TTFB: ${ttfb}ms`);<br />
            &nbsp;&nbsp;console.log(`å†…å®¹ä¸‹è½½: ${downloadTime}ms`);<br />
            &nbsp;&nbsp;console.log(`DOM è§£æ: ${domParse}ms`);<br />
            &nbsp;&nbsp;console.log(`èµ„æºåŠ è½½: ${resourceLoad}ms`);<br />
            &nbsp;&nbsp;console.log(`æ€»è€—æ—¶: ${pageLoad}ms`);<br />
            &nbsp;&nbsp;console.groupEnd();<br />
            });
          </div>

          <div class="highlight-box info" style="margin-top: 1.5rem">
            <strong>ğŸ“ å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰ï¼š</strong><br />
            â€¢
            <strong>LCP (Largest Contentful Paint)</strong
            >ï¼šæœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´ï¼Œåº” &lt; 2.5s<br />
            â€¢ <strong>FID (First Input Delay)</strong>ï¼šé¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼Œåº” &lt;
            100ms<br />
            â€¢ <strong>CLS (Cumulative Layout Shift)</strong>ï¼šç´¯ç§¯å¸ƒå±€åç§»ï¼Œåº”
            &lt; 0.1<br />
            â€¢ <strong>TTFB (Time to First Byte)</strong>ï¼šé¦–å­—èŠ‚æ—¶é—´ï¼Œåº” &lt;
            600ms
          </div>

          <h3 style="margin-top: 2.5rem">2. Performance Observer API</h3>
          <p style="line-height: 1.8; margin-bottom: 1rem">
            Performance Observer æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è§‚å¯Ÿè€…
            APIï¼Œå¯ä»¥ç›‘å¬å„ç§æ€§èƒ½äº‹ä»¶ï¼ŒåŒ…æ‹¬é•¿ä»»åŠ¡ã€å¸ƒå±€åç§»ã€èµ„æºåŠ è½½ç­‰ã€‚
          </p>

          <div class="code-block">
            // ğŸ¯ ç›‘æµ‹é•¿ä»»åŠ¡ (Long Tasks)<br />
            // é•¿ä»»åŠ¡å®šä¹‰ï¼šæ‰§è¡Œæ—¶é—´è¶…è¿‡ 50ms çš„ä»»åŠ¡<br />
            const longTaskObserver = new PerformanceObserver((list) => {<br />
            &nbsp;&nbsp;for (const entry of list.getEntries()) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;console.warn(`âš ï¸ é•¿ä»»åŠ¡æ£€æµ‹:
            ${entry.duration.toFixed(2)}ms`);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;console.warn(`èµ·å§‹æ—¶é—´:
            ${entry.startTime.toFixed(2)}ms`);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;// é•¿ä»»åŠ¡ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´é¡µé¢æ— å“åº”<br />
            &nbsp;&nbsp;}<br />
            });<br />
            longTaskObserver.observe({ entryTypes: ['longtask'] });<br />
            <br />
            // ğŸ¯ ç›‘æµ‹ Layout Shift (å¸ƒå±€åç§»)<br />
            let clsScore = 0;<br />
            const layoutShiftObserver = new PerformanceObserver((list) => {<br />
            &nbsp;&nbsp;for (const entry of list.getEntries()) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;if (!entry.hadRecentInput) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clsScore += entry.value;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(`ğŸ“ å¸ƒå±€åç§»:
            ${entry.value.toFixed(4)}`);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(`ç´¯ç§¯ CLS:
            ${clsScore.toFixed(4)}`);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;}<br />
            &nbsp;&nbsp;}<br />
            });<br />
            layoutShiftObserver.observe({ entryTypes: ['layout-shift'] });<br />
            <br />
            // ğŸ¯ ç›‘æµ‹ LCP (æœ€å¤§å†…å®¹ç»˜åˆ¶)<br />
            const lcpObserver = new PerformanceObserver((list) => {<br />
            &nbsp;&nbsp;const entries = list.getEntries();<br />
            &nbsp;&nbsp;const lastEntry = entries[entries.length - 1];<br />
            &nbsp;&nbsp;console.log(`ğŸ–¼ï¸ LCP: ${lastEntry.renderTime ||
            lastEntry.loadTime}ms`);<br />
            &nbsp;&nbsp;console.log(`LCP å…ƒç´ :`, lastEntry.element);<br />
            });<br />
            lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });
          </div>

          <h3 style="margin-top: 2.5rem">3. å®æ—¶å¸§ç‡ç›‘æµ‹</h3>
          <p style="line-height: 1.8; margin-bottom: 1rem">
            ä½¿ç”¨ requestAnimationFrame
            å¯ä»¥ç²¾ç¡®æµ‹é‡é¡µé¢çš„å®æ—¶å¸§ç‡ï¼Œè¿™å¯¹äºè°ƒè¯•åŠ¨ç”»æ€§èƒ½éå¸¸é‡è¦ã€‚
          </p>

          <div class="code-block">
            // é«˜ç²¾åº¦ FPS ç›‘æµ‹å™¨<br />
            class FPSMonitor {<br />
            &nbsp;&nbsp;constructor() {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.frames = [];<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.lastTime = performance.now();<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.fps = 60;<br />
            &nbsp;&nbsp;}<br />
            <br />
            &nbsp;&nbsp;measure() {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;const now = performance.now();<br />
            &nbsp;&nbsp;&nbsp;&nbsp;const delta = now - this.lastTime;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.lastTime = now;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;// æ”¶é›†æœ€è¿‘ 60 å¸§çš„æ•°æ®<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.frames.push(delta);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;if (this.frames.length > 60) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.frames.shift();<br />
            &nbsp;&nbsp;&nbsp;&nbsp;}<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;// è®¡ç®—å¹³å‡å¸§ç‡<br />
            &nbsp;&nbsp;&nbsp;&nbsp;const avg = this.frames.reduce((a, b) => a +
            b) / this.frames.length;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.fps = Math.round(1000 / avg);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;requestAnimationFrame(() =>
            this.measure());<br />
            &nbsp;&nbsp;}<br />
            &nbsp;&nbsp;<br />
            &nbsp;&nbsp;getFPS() {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;return this.fps;<br />
            &nbsp;&nbsp;}<br />
            }<br />
            <br />
            const monitor = new FPSMonitor();<br />
            monitor.measure();
          </div>

          <div class="highlight-box success" style="margin-top: 1.5rem">
            <strong>âœ… Chrome DevTools æ€§èƒ½åˆ†æå·¥å…·ï¼š</strong>
            <ul style="margin-top: 0.5rem; line-height: 2">
              <li>
                <strong>Performance é¢æ¿</strong
                >ï¼šå½•åˆ¶æ€§èƒ½ï¼ŒæŸ¥çœ‹ç«ç„°å›¾ï¼Œåˆ†æä¸»çº¿ç¨‹æ´»åŠ¨
              </li>
              <li>
                <strong>Rendering é¢æ¿</strong>ï¼šPaint
                Flashingï¼ˆé‡ç»˜é«˜äº®ï¼‰ã€Layer Bordersï¼ˆå›¾å±‚è¾¹ç•Œï¼‰
              </li>
              <li>
                <strong>Layers é¢æ¿</strong>ï¼š3D
                å›¾å±‚è§†å›¾ï¼ŒæŸ¥çœ‹æ¯ä¸ªå›¾å±‚çš„å†…å­˜å ç”¨
              </li>
              <li>
                <strong>Coverage é¢æ¿</strong>ï¼šæŸ¥æ‰¾æœªä½¿ç”¨çš„ CSS å’Œ JS ä»£ç 
              </li>
              <li><strong>Lighthouse</strong>ï¼šè‡ªåŠ¨åŒ–æ€§èƒ½å®¡è®¡ï¼Œç”Ÿæˆä¼˜åŒ–å»ºè®®</li>
            </ul>
          </div>
        </section>

        <!-- ç¬¬å…­éƒ¨åˆ†ï¼šä¼˜åŒ–å»ºè®® -->
        <section class="section">
          <h2>ğŸ¯ ç¬¬å…­é˜¶æ®µï¼šæ¸²æŸ“ä¼˜åŒ–æœ€ä½³å®è·µ</h2>

          <div class="comparison-grid">
            <div class="comparison-card">
              <h4>1ï¸âƒ£ å‡å°‘ Reflow</h4>
              <p style="line-height: 1.8; margin-bottom: 1rem">
                Reflowï¼ˆå›æµ/é‡æ’ï¼‰æ˜¯æµè§ˆå™¨é‡æ–°è®¡ç®—å…ƒç´ å‡ ä½•å±æ€§çš„è¿‡ç¨‹ï¼Œå¼€é”€æå¤§ã€‚å…³é”®åœ¨äºä½¿ç”¨
                GPU åŠ é€Ÿçš„å±æ€§æ›¿ä»£å‡ ä½•å±æ€§ã€‚
              </p>

              <div class="highlight-box" style="margin-bottom: 1rem">
                <strong>ğŸ’¥ ä¸ºä»€ä¹ˆè¿™æ ·ç³Ÿç³•ï¼š</strong><br />
                æ¯æ¬¡ä¿®æ”¹ <code>width</code>ã€<code>height</code>ã€<code
                  >margin</code
                >
                ç­‰å‡ ä½•å±æ€§æ—¶ï¼Œæµè§ˆå™¨éƒ½éœ€è¦ï¼š<br />
                1ï¸âƒ£ é‡æ–°è®¡ç®—å—å½±å“å…ƒç´ çš„å¸ƒå±€ï¼ˆLayoutï¼‰<br />
                2ï¸âƒ£ éå†æ¸²æŸ“æ ‘ï¼Œå½±å“å¯èƒ½æ³¢åŠæ•´ä¸ªé¡µé¢<br />
                3ï¸âƒ£ é‡æ–°ç»˜åˆ¶ï¼ˆPaintï¼‰<br />
                4ï¸âƒ£ é‡æ–°åˆæˆï¼ˆCompositeï¼‰
              </div>

              <div class="code-block" style="margin-top: 1rem">
                // âŒ ç³Ÿç³•ï¼šæ¯æ¬¡å¾ªç¯éƒ½è§¦å‘ reflow<br />
                for (let i = 0; i < 100; i++) {<br />
                &nbsp;&nbsp;el.style.width = i + 'px'; // è§¦å‘å®Œæ•´æ¸²æŸ“æµç¨‹ï¼<br />
                }<br />
                <br />
                // âœ… ä¼˜åŒ–ï¼šä½¿ç”¨ transform<br />
                el.style.transform = `scaleX(${scale})`;<br />
                // åªè§¦å‘ Compositeï¼Œåœ¨ GPU ä¸Šæ‰§è¡Œ
              </div>

              <div class="highlight-box success" style="margin-top: 1rem">
                <strong>ğŸš€ æ–°ç‰¹æ€§ï¼šcontent-visibility</strong><br />
                ä½¿ç”¨
                <code>content-visibility: auto</code>
                å¯ä»¥è®©æµè§ˆå™¨è·³è¿‡å±å¹•å¤–å…ƒç´ çš„æ¸²æŸ“å·¥ä½œï¼ˆåŒ…æ‹¬ Layout å’Œ
                Paintï¼‰ï¼Œç›´åˆ°å®ƒä»¬è¿›å…¥è§†å£ã€‚è¿™å¯¹äºé•¿åˆ—è¡¨æ€§èƒ½æå‡å·¨å¤§ï¼
              </div>
            </div>

            <div class="comparison-card">
              <h4>2ï¸âƒ£ æ‰¹é‡ DOM æ“ä½œ</h4>
              <p style="line-height: 1.8; margin-bottom: 1rem">
                DocumentFragment æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ–‡æ¡£å¯¹è±¡ï¼Œå®ƒä¸æ˜¯çœŸå® DOM
                æ ‘çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å…¶ä¸Šè¿›è¡Œæ“ä½œä¸ä¼šè§¦å‘é¡µé¢é‡æ’ã€‚
              </p>

              <div class="code-block" style="margin-top: 1rem">
                // âŒ ç³Ÿç³•ï¼šå¤šæ¬¡æ’å…¥è§¦å‘å¤šæ¬¡ reflow<br />
                for (let i = 0; i < 100; i++) {<br />
                &nbsp;&nbsp;container.appendChild(createEl());<br />
                &nbsp;&nbsp;// æ¯æ¬¡ appendChild éƒ½ä¼šï¼š<br />
                &nbsp;&nbsp;// 1. è§¦å‘ä¸€æ¬¡ Reflow<br />
                &nbsp;&nbsp;// 2. é‡æ–°è®¡ç®— container çš„å°ºå¯¸<br />
                &nbsp;&nbsp;// 3. è§¦å‘ä¸€æ¬¡ Repaint<br />
                }<br />
                // æ€»å…±ï¼š100 æ¬¡ Reflow + 100 æ¬¡ Repaint = ğŸ’¥<br />
                <br />
                // âœ… ä¼˜åŒ–ï¼šä½¿ç”¨ DocumentFragment<br />
                const frag = document.createDocumentFragment();<br />
                for (let i = 0; i < 100; i++) {<br />
                &nbsp;&nbsp;frag.appendChild(createEl());<br />
                &nbsp;&nbsp;// åœ¨å†…å­˜ä¸­æ“ä½œï¼Œä¸è§¦å‘æ¸²æŸ“<br />
                }<br />
                container.appendChild(frag); // åªè§¦å‘ 1 æ¬¡ï¼<br />
                // æ€»å…±ï¼š1 æ¬¡ Reflow + 1 æ¬¡ Repaint = âœ…
              </div>

              <div class="highlight-box info" style="margin-top: 1rem">
                <strong>ğŸ’¡ è§†è§‰æ›´æ–°çš„æœ€ä½³æ—¶æœºï¼š</strong><br />
                å¦‚æœå¿…é¡»è¿›è¡Œ DOM æ“ä½œï¼Œæœ€å¥½åœ¨
                <code>requestAnimationFrame</code>
                å›è°ƒä¸­è¿›è¡Œã€‚è¿™èƒ½ç¡®ä¿åœ¨æµè§ˆå™¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œï¼Œé¿å…åœ¨ä¸€å¸§å†…å¤šæ¬¡å¼ºåˆ¶é‡æ’ã€‚
              </div>
            </div>

            <div class="comparison-card">
              <h4>3ï¸âƒ£ ä½¿ç”¨ CSS åŠ¨ç”»</h4>
              <p style="line-height: 1.8; margin-bottom: 1rem">
                CSS
                åŠ¨ç”»ç”±æµè§ˆå™¨çš„<strong>åˆæˆå™¨çº¿ç¨‹</strong>å¤„ç†ï¼Œä¸ä¸»çº¿ç¨‹åˆ†ç¦»ï¼Œå³ä½¿
                JavaScript ç¹å¿™ä¹Ÿèƒ½ä¿æŒæµç•…ã€‚
              </p>

              <div class="highlight-box" style="margin-bottom: 1rem">
                <strong>âš ï¸ JavaScript åŠ¨ç”»çš„é—®é¢˜ï¼š</strong><br />
                â€¢ è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œå— JS æ‰§è¡Œé˜»å¡<br />
                â€¢ <code>setInterval/setTimeout</code> ç²¾åº¦ä¸å¤Ÿï¼Œå¯èƒ½ä¸¢å¸§<br />
                â€¢ å³ä½¿ç”¨ <code>requestAnimationFrame</code>ï¼Œä¿®æ”¹
                <code>left/top</code> ä»ä¼šè§¦å‘ Layout<br />
                â€¢ æ— æ³•åˆ©ç”¨æµè§ˆå™¨çš„ä¼˜åŒ–ï¼ˆå¦‚æ ‡ç­¾é¡µä¸å¯è§æ—¶æš‚åœï¼‰
              </div>

              <div class="code-block" style="margin-top: 1rem">
                /* âŒ é¿å…ç”¨ JS æ”¹å˜ä½ç½® */<br />
                setInterval(() => {<br />
                &nbsp;&nbsp;el.style.left = x + 'px'; // è§¦å‘ Reflowï¼<br />
                }, 16); // 16.67ms â‰ˆ 60fpsï¼Œä½†æ— æ³•ä¿è¯<br />
                <br />
                /* âœ… ä½¿ç”¨ CSS transform + transition */<br />
                .animated {<br />
                &nbsp;&nbsp;transition: transform 0.3s ease-out;<br />
                &nbsp;&nbsp;transform: translateX(100px);<br />
                &nbsp;&nbsp;/* æµè§ˆå™¨è‡ªåŠ¨ä¼˜åŒ–ä¸º 60fps */<br />
                &nbsp;&nbsp;/* åœ¨åˆæˆçº¿ç¨‹æ‰§è¡Œï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ */<br />
                }<br />
                <br />
                /* ğŸš€ æ›´å¤æ‚çš„åŠ¨ç”»ç”¨ @keyframes */<br />
                @keyframes slide {<br />
                &nbsp;&nbsp;from { transform: translateX(0); }<br />
                &nbsp;&nbsp;to { transform: translateX(100px); }<br />
                }
              </div>

              <div class="highlight-box success" style="margin-top: 1rem">
                <strong>âœ… åˆæˆå™¨ç‹¬æœ‰å±æ€§ (Compositor-Only)ï¼š</strong><br />
                åšæŒä½¿ç”¨ <code>transform</code> å’Œ
                <code>opacity</code>ã€‚åªæœ‰è¿™ä¸¤ä¸ªå±æ€§ä¿è¯åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šè§¦å‘
                Layout æˆ– Paintï¼Œå§‹ç»ˆç”±åˆæˆçº¿ç¨‹å¤„ç†ã€‚
              </div>
            </div>

            <div class="comparison-card">
              <h4>4ï¸âƒ£ é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€</h4>
              <p style="margin-bottom: 1rem; line-height: 1.8">
                è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„æµè§ˆå™¨æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–é—®é¢˜ã€‚æ ¸å¿ƒåŸå› åœ¨äºæµè§ˆå™¨çš„<strong
                  >æ¸²æŸ“é˜Ÿåˆ—æœºåˆ¶ï¼ˆRender Queueï¼‰</strong
                >å’Œ<strong>æ‡’è®¡ç®—ï¼ˆLazy Evaluationï¼‰</strong>ç­–ç•¥ã€‚
              </p>

              <div class="highlight-box info" style="margin-bottom: 1rem">
                <strong>ğŸ§  æµè§ˆå™¨çš„"æ‡’"ç­–ç•¥ï¼š</strong><br />
                æµè§ˆå™¨å¾ˆ"æ‡’"ï¼Œå®ƒæ€»æ˜¯æƒ³æŠŠæ‰€æœ‰çš„æ ·å¼ä¿®æ”¹ç§¯æ”’èµ·æ¥ï¼Œä¸€æ¬¡æ€§ç»Ÿä¸€è®¡ç®—ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨ä¿®æ”¹äº†æ ·å¼ä¹‹åç«‹å³å»"è¯»å–"å¸ƒå±€ä¿¡æ¯ï¼Œæµè§ˆå™¨å°±è¢«è¿«æš‚åœç§¯æ”’ï¼Œå¿…é¡»ç«‹å³ã€é©¬ä¸Šè®¡ç®—å‡ºæœ€æ–°çš„å¸ƒå±€ç»“æœç»™ä½ ï¼Œè¿™å°±ç ´åäº†æµè§ˆå™¨çš„ä¼˜åŒ–æœºåˆ¶ã€‚
              </div>

              <h4
                style="
                  font-size: 1.1rem;
                  color: #fc8181;
                  margin: 1.5rem 0 0.5rem 0;
                "
              >
                âŒ æƒ…å†µä¸€ï¼šå¼ºåˆ¶åŒæ­¥å¸ƒå±€ (Write â†’ Read â†’ Write)
              </h4>
              <div class="code-block" style="margin-top: 1rem">
                // 1. Write (å†™)<br />
                el.style.width = '100px';<br />
                // æµè§ˆå™¨åŠ¨ä½œï¼šæŠŠè¿™ä¸ªä¿®æ”¹æ”¾å…¥æ¸²æŸ“é˜Ÿåˆ—<br />
                // æ ‡è®°å¸ƒå±€ä¸º"è„ï¼ˆDirtyï¼‰"<br />
                // æ­¤æ—¶ï¼Œæµè§ˆå™¨è¿˜æ²¡çœŸæ­£è®¡ç®— el çš„æ–°å®½åº¦<br />
                <br />
                // 2. Read (è¯»)<br />
                const h = el.offsetHeight;<br />
                // âš ï¸ æµè§ˆå™¨å‘ç°å¸ƒå±€æ˜¯"è„"çš„<br />
                // è¢«è¿«ç«‹åˆ»è¿›è¡Œä¸€æ¬¡ Layoutï¼ˆé‡æ’ï¼‰<br />
                // ===> è¿™å°±æ˜¯"å¼ºåˆ¶åŒæ­¥å¸ƒå±€" <===<br />
                <br />
                // 3. Write (å†™)<br />
                el.style.height = h + 'px';<br />
                // å¸ƒå±€å†æ¬¡å˜"è„"
              </div>

              <div class="highlight-box" style="margin: 1rem 0">
                <strong>ğŸ’¥ ç»“æœï¼š</strong
                >åœ¨è¿™ä¸€æ®µä»£ç é‡Œï¼Œæµè§ˆå™¨è¢«è¿«åœ¨ä¸­é—´è¿›è¡Œäº†ä¸€æ¬¡é¢å¤–çš„ã€æ˜‚è´µçš„å¸ƒå±€è®¡ç®—ã€‚å¦‚æœè¿™å‘ç”Ÿåœ¨ä¸€ä¸ªå¾ªç¯é‡Œï¼Œæ€§èƒ½ä¼š<strong>ç¾éš¾æ€§ä¸‹é™</strong>ï¼ˆLayout
                Thrashingï¼‰ã€‚
              </div>

              <h4
                style="
                  font-size: 1.1rem;
                  color: #48bb78;
                  margin: 1.5rem 0 0.5rem 0;
                "
              >
                âœ… æƒ…å†µäºŒï¼šå…ˆè¯»åå†™ (Read â†’ Write â†’ Write)
              </h4>
              <div class="code-block" style="margin-top: 1rem">
                // 1. Read (è¯»)<br />
                const h = el.offsetHeight;<br />
                // æµè§ˆå™¨åŠ¨ä½œï¼šæ£€æŸ¥å¸ƒå±€çŠ¶æ€<br />
                // å¦‚æœå¸ƒå±€æ˜¯"å¹²å‡€"çš„ï¼Œç›´æ¥è¿”å›ç¼“å­˜é«˜åº¦<br />
                // é€Ÿåº¦æå¿«ï¼<br />
                <br />
                // 2. Write (å†™)<br />
                el.style.width = '100px';<br />
                // æµè§ˆå™¨åŠ¨ä½œï¼šæ”¾å…¥æ¸²æŸ“é˜Ÿåˆ—ï¼Œæ ‡è®°ä¸º"è„"<br />
                <br />
                // 3. Write (å†™)<br />
                el.style.height = h + 'px';<br />
                // ç»§ç»­æ”¾å…¥é˜Ÿåˆ—<br />
                <br />
                // ...è„šæœ¬ç»“æŸ...<br />
                // æµè§ˆå™¨ç»Ÿä¸€å¤„ç†é˜Ÿåˆ—ï¼Œåªè¿›è¡Œä¸€æ¬¡ Layout
              </div>

              <div class="highlight-box success" style="margin-top: 1rem">
                <strong>ğŸš€ ç»“æœï¼š</strong
                >åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ï¼Œæ‰€æœ‰å†™å…¥æ“ä½œéƒ½åœ¨æœ€åï¼Œæµè§ˆå™¨å¯ä»¥åœ¨ä¸‹ä¸€å¸§æ¸²æŸ“å‰ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ ·å¼éƒ½è®¡ç®—å¥½ã€‚
              </div>

              <h4
                style="
                  font-size: 1.1rem;
                  color: #667eea;
                  margin: 1.5rem 0 0.5rem 0;
                "
              >
                ğŸ“ å½¢è±¡çš„æ¯”å–»
              </h4>
              <p style="line-height: 1.8; margin-bottom: 0.5rem">
                æŠŠæµè§ˆå™¨æƒ³è±¡æˆä¸€ä¸ªä¼šè®¡ï¼š
              </p>
              <ul style="line-height: 2; margin-left: 1.5rem">
                <li>
                  <strong style="color: #fc8181"
                    >âŒ åè€æ¿ï¼ˆå¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼‰ï¼š</strong
                  ><br />
                  è€æ¿ï¼šæŠŠè¿™ä¸ªè´¦ç›®çš„æ”¶å…¥æ”¹æˆ 100 å—ã€‚ï¼ˆå†™ï¼‰<br />
                  è€æ¿ï¼šç°åœ¨æ€»åˆ©æ¶¦æ˜¯å¤šå°‘ï¼Ÿï¼ˆè¯»ï¼‰<br />
                  ä¼šè®¡ï¼šï¼ˆå´©æºƒï¼‰ä½†æˆ‘è¿˜æ²¡ç®—è¿›å»åˆšæ‰é‚£ 100
                  å—å‘¢ï¼ä¸å¾—ä¸åœä¸‹æ‰‹å¤´æ‰€æœ‰å·¥ä½œï¼Œç«‹åˆ»æ‹¿å‡ºè®¡ç®—å™¨é‡æ–°ç®—ä¸€éæŠ¥è¡¨ç»™ä½ çœ‹ã€‚
                </li>
                <li style="margin-top: 0.8rem">
                  <strong style="color: #48bb78">âœ… å¥½è€æ¿ï¼ˆæ‰¹é‡å¤„ç†ï¼‰ï¼š</strong
                  ><br />
                  è€æ¿ï¼šä¸Šä¸ªæœˆçš„åˆ©æ¶¦è¡¨ç»™æˆ‘çœ‹ä¸€çœ¼ã€‚ï¼ˆè¯» â€”â€”
                  ç›´æ¥æ‹¿æ¡Œä¸Šç°æˆçš„æŠ¥è¡¨ï¼‰<br />
                  è€æ¿ï¼šæŠŠè¿™ä¸ªè´¦ç›®æ”¶å…¥æ”¹ 100 å—ã€‚ï¼ˆå†™ï¼‰<br />
                  è€æ¿ï¼šæŠŠæ”¯å‡ºæ”¹æˆåˆšæ‰é‚£ä¸ªåˆ©æ¶¦çš„ä¸€åŠã€‚ï¼ˆå†™ï¼‰<br />
                  ä¼šè®¡ï¼šå¥½çš„ï¼Œç­‰æ‚¨éƒ½å©å’å®Œäº†ï¼Œæˆ‘ä»Šæ™šç»Ÿä¸€ç®—ä¸€éæ–°çš„æŠ¥è¡¨ã€‚ï¼ˆæ‰¹é‡ä¼˜åŒ–ï¼‰
                </li>
              </ul>
            </div>

            <div class="comparison-card">
              <h4>5ï¸âƒ£ ä½¿ç”¨ will-change</h4>
              <p style="line-height: 1.8; margin-bottom: 1rem">
                <code>will-change</code>
                æ˜¯ä¸€ä¸ªæç¤ºæµè§ˆå™¨æå‰ä¼˜åŒ–çš„å±æ€§ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨æŸä¸ªå…ƒç´ å³å°†å‘ç”Ÿå˜åŒ–ï¼Œæµè§ˆå™¨å¯ä»¥æå‰åšå‡†å¤‡ã€‚
              </p>

              <div class="highlight-box info" style="margin-bottom: 1rem">
                <strong>ğŸ§  æµè§ˆå™¨å¦‚ä½•å“åº” will-changeï¼š</strong><br />
                1ï¸âƒ£ ä¸ºè¯¥å…ƒç´ åˆ›å»ºç‹¬ç«‹çš„<strong>åˆæˆå›¾å±‚</strong><br />
                2ï¸âƒ£ æå‰åˆ†é… GPU å†…å­˜å’Œèµ„æº<br />
                3ï¸âƒ£ é¿å…åœ¨åŠ¨ç”»æ—¶ä¸´æ—¶åˆ›å»ºå›¾å±‚ï¼ˆå¯¼è‡´é—ªçƒï¼‰<br />
                4ï¸âƒ£ ä¼˜åŒ–åŠ¨ç”»çš„æ¸²æŸ“è·¯å¾„
              </div>

              <div class="code-block" style="margin-top: 1rem">
                /* âœ… æ­£ç¡®ä½¿ç”¨ */<br />
                .will-animate {<br />
                &nbsp;&nbsp;will-change: transform, opacity;<br />
                &nbsp;&nbsp;/* åªåœ¨å³å°†åŠ¨ç”»çš„å…ƒç´ ä¸Šä½¿ç”¨ */<br />
                }<br />
                <br />
                /* ğŸ¯ åŠ¨æ€æ·»åŠ å’Œç§»é™¤ */<br />
                el.addEventListener('mouseenter', () => {<br />
                &nbsp;&nbsp;el.style.willChange = 'transform';<br />
                });<br />
                el.addEventListener('animationend', () => {<br />
                &nbsp;&nbsp;el.style.willChange = 'auto'; // åŠ¨ç”»åç§»é™¤ï¼<br />
                });
              </div>

              <div class="highlight-box" style="margin-top: 1rem">
                <strong>âš ï¸ æ³¨æ„ï¼šä¸è¦æ»¥ç”¨ will-change</strong><br />
                â€¢ æ¯ä¸ªå›¾å±‚æ¶ˆè€—é¢å¤–å†…å­˜ï¼ˆå‡  MB ~ å‡ å MBï¼‰<br />
                â€¢ è¿‡å¤šå›¾å±‚å¯¼è‡´<strong>å†…å­˜æº¢å‡º</strong>ï¼Œåè€Œå¡é¡¿<br />
                â€¢ <strong>ä¸è¦</strong>åœ¨å…¨å±€æˆ–
                <code>*</code> é€‰æ‹©å™¨ä¸Šä½¿ç”¨<br />
                â€¢ <strong>ä¸è¦</strong>åœ¨ä¸ä¼šåŠ¨ç”»çš„å…ƒç´ ä¸Šä½¿ç”¨<br />
                â€¢ åŠ¨ç”»ç»“æŸååº”<strong>ç§»é™¤</strong> will-change
              </div>

              <div class="code-block" style="margin-top: 1rem">
                /* âŒ ç»å¯¹ä¸è¦è¿™æ ·åš */<br />
                * {<br />
                &nbsp;&nbsp;will-change: transform; /* ç¾éš¾ï¼*/<br />
                }
              </div>
            </div>

            <div class="comparison-card">
              <h4>6ï¸âƒ£ å»¶è¿Ÿéå…³é”®æ¸²æŸ“</h4>
              <p style="line-height: 1.8; margin-bottom: 1rem">
                <code>requestIdleCallback</code>
                è®©æµè§ˆå™¨åœ¨ç©ºé—²æ—¶æ‰§è¡Œä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œé¿å…é˜»å¡å…³é”®æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’ã€‚
              </p>

              <div class="highlight-box info" style="margin-bottom: 1rem">
                <strong>â±ï¸ æµè§ˆå™¨çš„å¸§é¢„ç®—ï¼ˆFrame Budgetï¼‰ï¼š</strong><br />
                â€¢ 60fps = æ¯å¸§ 16.67ms<br />
                â€¢ æµè§ˆå™¨éœ€è¦å®Œæˆï¼šLayout + Paint + Composite + JSæ‰§è¡Œ<br />
                â€¢ å¦‚æœä¸€å¸§å†…å®Œä¸æˆæ‰€æœ‰ä»»åŠ¡ â†’ <strong>æ‰å¸§ã€å¡é¡¿</strong><br />
                â€¢
                <code>requestIdleCallback</code>
                åœ¨æ¯å¸§<strong>å‰©ä½™æ—¶é—´</strong>æ‰§è¡Œ
              </div>

              <div class="code-block" style="margin-top: 1rem">
                // âœ… å»¶è¿Ÿéå…³é”®æ¸²æŸ“<br />
                requestIdleCallback((deadline) => {<br />
                &nbsp;&nbsp;// deadline.timeRemaining() è¿”å›å‰©ä½™æ—¶é—´<br />
                &nbsp;&nbsp;while (deadline.timeRemaining() > 0 && tasks.length)
                {<br />
                &nbsp;&nbsp;&nbsp;&nbsp;const task = tasks.shift();<br />
                &nbsp;&nbsp;&nbsp;&nbsp;task(); // æ‰§è¡Œä½ä¼˜å…ˆçº§ä»»åŠ¡<br />
                &nbsp;&nbsp;}<br />
                &nbsp;&nbsp;<br />
                &nbsp;&nbsp;// å¦‚æœè¿˜æœ‰ä»»åŠ¡ï¼Œæ”¾åˆ°ä¸‹ä¸€ä¸ªç©ºé—²æœŸ<br />
                &nbsp;&nbsp;if (tasks.length) {<br />
                &nbsp;&nbsp;&nbsp;&nbsp;requestIdleCallback(arguments.callee);<br />
                &nbsp;&nbsp;}<br />
                }, { timeout: 2000 }); // æœ€å¤šç­‰å¾… 2 ç§’<br />
                <br />
                // ğŸ¯ é€‚ç”¨åœºæ™¯ï¼š<br />
                // â€¢ åˆ†æå’Œä¸ŠæŠ¥ç»Ÿè®¡æ•°æ®<br />
                // â€¢ é¢„åŠ è½½ä¸‹ä¸€é¡µå†…å®¹<br />
                // â€¢ å›¾ç‰‡æ‡’åŠ è½½çš„é¢„å¤„ç†<br />
                // â€¢ éå¯è§†åŒºåŸŸçš„æ¸²æŸ“
              </div>

              <div class="highlight-box success" style="margin-top: 1rem">
                <strong>ğŸ¯ æœ€ä½³å®è·µï¼šä¼˜å…ˆçº§åˆ†å±‚</strong><br />
                1ï¸âƒ£ <strong>å…³é”®è·¯å¾„</strong>ï¼šé¦–å±æ¸²æŸ“ã€ç”¨æˆ·äº¤äº’ â†’ ç«‹å³æ‰§è¡Œ<br />
                2ï¸âƒ£ <strong>é‡è¦ä½†ä¸ç´§æ€¥</strong>ï¼šæ•°æ®é¢„åŠ è½½ â†’
                <code>setTimeout</code><br />
                3ï¸âƒ£ <strong>å¯å»¶è¿Ÿ</strong>ï¼šåˆ†æã€æ—¥å¿— â†’
                <code>requestIdleCallback</code>
              </div>
            </div>
          </div>
        </section>

        <!-- æ€»ç»“ -->
        <section class="section">
          <h2>ğŸ“ æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h2>

          <div class="highlight-box success">
            <h3 style="margin-top: 0">ğŸ¯ å…³é”®æ¸²æŸ“è·¯å¾„å®Œæ•´æµç¨‹</h3>
            <ol style="line-height: 2; margin-left: 1.5rem">
              <li><strong>å­—èŠ‚æµ</strong> â†’ é€šè¿‡ç½‘ç»œæ¥æ”¶ HTML å­—èŠ‚</li>
              <li><strong>å­—ç¬¦</strong> â†’ æ ¹æ®ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦</li>
              <li><strong>ä»¤ç‰Œ</strong> â†’ è¯æ³•åˆ†æç”Ÿæˆ HTML ä»¤ç‰Œ</li>
              <li><strong>DOM</strong> â†’ æ„å»ºæ–‡æ¡£å¯¹è±¡æ¨¡å‹æ ‘</li>
              <li><strong>CSSOM</strong> â†’ å¹¶è¡Œæ„å»º CSS å¯¹è±¡æ¨¡å‹æ ‘</li>
              <li><strong>Render Tree</strong> â†’ åˆå¹¶ DOM å’Œ CSSOM</li>
              <li><strong>Layout</strong> â†’ è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯</li>
              <li><strong>Paint</strong> â†’ å°†æ¸²æŸ“æ ‘è½¬æ¢ä¸ºåƒç´ </li>
              <li><strong>Composite</strong> â†’ åˆæˆå›¾å±‚å¹¶æ˜¾ç¤ºåˆ°å±å¹•</li>
            </ol>
          </div>

          <div class="highlight-box" style="margin-top: 2rem">
            <h3 style="margin-top: 0">âš¡ æ€§èƒ½ä¼˜åŒ–é»„é‡‘æ³•åˆ™</h3>
            <ul style="line-height: 2; margin-left: 1.5rem">
              <li>
                <strong>ä¼˜å…ˆä½¿ç”¨ Composite</strong>ï¼štransform å’Œ opacity
                æ˜¯æœ€å¿«çš„
              </li>
              <li><strong>é¿å… Reflow</strong>ï¼šå°½é‡ä¸æ”¹å˜å‡ ä½•å±æ€§</li>
              <li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼šå‡å°‘ DOM æ“ä½œæ¬¡æ•°</li>
              <li><strong>å¼‚æ­¥åŠ è½½</strong>ï¼šä½¿ç”¨ defer/async åŠ è½½è„šæœ¬</li>
              <li><strong>CSS åœ¨å‰ï¼ŒJS åœ¨å</strong>ï¼šé¿å…é˜»å¡æ¸²æŸ“</li>
            </ul>
          </div>
        </section>
      </main>
    </div>

    <script>
      // FPS ç›‘æµ‹
      let lastTime = performance.now();
      let frames = 0;
      let fps = 60;

      function updateFPS() {
        frames++;
        const now = performance.now();

        if (now >= lastTime + 1000) {
          fps = Math.round((frames * 1000) / (now - lastTime));
          document.getElementById("fpsValue").textContent = fps;

          // æ ¹æ® FPS æ”¹å˜é¢œè‰²
          const fpsEl = document.getElementById("fpsValue");
          if (fps >= 55) {
            fpsEl.style.color = "#48bb78"; // ç»¿è‰²
          } else if (fps >= 30) {
            fpsEl.style.color = "#ecc94b"; // é»„è‰²
          } else {
            fpsEl.style.color = "#fc8181"; // çº¢è‰²
          }

          frames = 0;
          lastTime = now;
        }

        requestAnimationFrame(updateFPS);
      }
      updateFPS();

      // æ€§èƒ½æ—¥å¿—
      function addLog(message, type = "info") {
        const monitor = document.getElementById("performanceMonitor");
        const time = new Date().toLocaleTimeString();
        const logClass = type ? `log-type-${type}` : "";

        const entry = document.createElement("div");
        entry.className = "log-entry";
        entry.innerHTML = `<span class="log-time">[${time}]</span> <span class="${logClass}">${message}</span>`;

        monitor.appendChild(entry);
        monitor.scrollTop = monitor.scrollHeight;
      }

      // æ­¥éª¤è¯¦æƒ…
      const stepDetails = {
        dom: {
          title: "DOM (Document Object Model)",
          content: `
                    <p>DOM æ˜¯ HTML æ–‡æ¡£çš„ç¨‹åºæ¥å£ï¼Œå°† HTML è§£æä¸ºæ ‘çŠ¶ç»“æ„ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†å±æ€§å’Œæ–¹æ³•ã€‚</p>
                    <div class="code-block">
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="app"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;æ ‡é¢˜&lt;/h1&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;
                    </div>
                    <p><strong>å…³é”®ç‚¹ï¼š</strong>DOM æ„å»ºæ˜¯å¢é‡çš„ï¼Œè¾¹è§£æè¾¹æ„å»ºã€‚æµè§ˆå™¨ä¸éœ€è¦ç­‰å¾…æ•´ä¸ª HTML æ–‡æ¡£ä¸‹è½½å®Œæˆå°±å¯ä»¥å¼€å§‹æ„å»º DOM æ ‘ã€‚</p>
                `,
        },
        cssom: {
          title: "CSSOM (CSS Object Model)",
          content: `
                    <p>CSSOM æ˜¯ CSS çš„å¯¹è±¡æ¨¡å‹ã€‚æµè§ˆå™¨å°† CSS è§£æä¸ºæ ‘çŠ¶ç»“æ„ï¼Œå¹¶è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„æœ€ç»ˆæ ·å¼ï¼ˆComputed Styleï¼‰ã€‚</p>
                    <div class="highlight-box">
                        <strong>âš ï¸ é˜»å¡æ¸²æŸ“ï¼š</strong>CSS æ˜¯æ¸²æŸ“é˜»å¡èµ„æºï¼æµè§ˆå™¨å¿…é¡»ç­‰å¾… CSSOM æ„å»ºå®Œæˆæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥ï¼ˆRender Treeï¼‰ã€‚è¿™æ˜¯å› ä¸º CSS å…·æœ‰"å±‚å "ï¼ˆCascadingï¼‰ç‰¹æ€§ï¼ŒååŠ è½½çš„æ ·å¼å¯èƒ½è¦†ç›–å‰é¢çš„æ ·å¼ï¼Œå¦‚æœæå‰æ¸²æŸ“ä¼šå¯¼è‡´é¡µé¢é—ªçƒã€‚
                    </div>
                    <p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p>
                    <ul>
                        <li>å†…è”å…³é”® CSS (Critical CSS)</li>
                        <li>ä½¿ç”¨ media å±æ€§å¼‚æ­¥åŠ è½½éå…³é”® CSS</li>
                        <li>é¿å…ä½¿ç”¨ @import (ä¼šä¸²è¡ŒåŠ è½½)</li>
                    </ul>
                `,
        },
        render: {
          title: "Render Tree (æ¸²æŸ“æ ‘)",
          content: `
                    <p>æ¸²æŸ“æ ‘æ˜¯ DOM å’Œ CSSOM çš„ç»“åˆï¼ŒåªåŒ…å«<strong>éœ€è¦æ˜¾ç¤º</strong>çš„èŠ‚ç‚¹ã€‚å®ƒæ˜¯å¯è§†å…ƒç´ çš„è“å›¾ã€‚</p>
                    <div class="highlight-box info">
                        <strong>æ³¨æ„åŒºåˆ«ï¼š</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li><strong>DOM æ ‘ï¼š</strong>åŒ…å«æ‰€æœ‰ HTML æ ‡ç­¾ï¼ˆåŒ…æ‹¬ head, script, metaï¼‰ã€‚</li>
                            <li><strong>æ¸²æŸ“æ ‘ï¼š</strong>å»é™¤ä¸å¯è§å…ƒç´ ï¼ˆdisplay: noneï¼‰ï¼Œä½†åŒ…å«ä¼ªå…ƒç´ ï¼ˆ::before, ::afterï¼‰ã€‚</li>
                        </ul>
                    </div>
                    <p><strong>visibility: hidden vs display: noneï¼š</strong></p>
                    <ul>
                        <li><code>visibility: hidden</code>ï¼šå…ƒç´ åœ¨æ¸²æŸ“æ ‘ä¸­ï¼Œå æ®ç©ºé—´ï¼Œåªæ˜¯ä¸å¯è§ã€‚</li>
                        <li><code>display: none</code>ï¼šå…ƒç´ <strong>ä¸åœ¨</strong>æ¸²æŸ“æ ‘ä¸­ï¼Œä¸å æ®ç©ºé—´ã€‚</li>
                    </ul>
                `,
        },
        layout: {
          title: "Layout (å¸ƒå±€/å›æµ)",
          content: `
                    <p>Layout é˜¶æ®µï¼ˆä¹Ÿç§° Reflowï¼‰è®¡ç®—æ¸²æŸ“æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹åœ¨å±å¹•ä¸Šçš„ç¡®åˆ‡åæ ‡å’Œå¤§å°ã€‚æµè§ˆå™¨ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ ¹æ®ç›’æ¨¡å‹è®¡ç®—å‡ ä½•ä¿¡æ¯ã€‚</p>
                    <div class="code-block">
// æµè§ˆå™¨è®¡ç®—ï¼š<br>
- ç›’æ¨¡å‹ï¼šwidth, height, padding, border, margin<br>
- åæ ‡ç³»ç»Ÿï¼šç›¸å¯¹äºè§†å£ (Viewport) çš„ x, y åæ ‡<br>
- æµ®åŠ¨å’Œæ¸…é™¤ï¼šfloat, clear<br>
- æ–‡æœ¬æ¢è¡Œå’Œæº¢å‡ºå¤„ç†
                    </div>
                    <div class="highlight-box">
                        <strong>ğŸ’¥ æ€§èƒ½æ€æ‰‹ï¼š</strong>Layout æ˜¯ä¸»çº¿ç¨‹ä¸Šæœ€æ˜‚è´µçš„æ“ä½œä¹‹ä¸€ã€‚è¯»å– offsetHeight ç­‰å±æ€§ä¼šå¼ºåˆ¶æµè§ˆå™¨ç«‹å³æ‰§è¡Œ Layoutï¼ˆå¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼‰ã€‚
                    </div>
                `,
        },
        paint: {
          title: "Paint (ç»˜åˆ¶)",
          content: `
                    <p>Paint é˜¶æ®µå°†å¸ƒå±€åçš„æ¸²æŸ“æ ‘è½¬æ¢ä¸ºå±å¹•ä¸Šçš„å®é™…åƒç´ ã€‚è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºåœ¨ç”»å¸ƒä¸Šç”»ç”»ï¼Œä¹Ÿç§°ä¸º"æ …æ ¼åŒ–"ï¼ˆRasterizationï¼‰ã€‚</p>
                    <p><strong>ç»˜åˆ¶é¡ºåºï¼ˆStacking Contextï¼‰ï¼š</strong></p>
                    <ol style="line-height: 2;">
                        <li>èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾ç‰‡</li>
                        <li>è¾¹æ¡† (Border)</li>
                        <li>å­å…ƒç´  (Children)</li>
                        <li>è½®å»“ (Outline)</li>
                    </ol>
                    <div class="highlight-box info">
                        <strong>ç»˜åˆ¶åˆ—è¡¨ï¼ˆDraw Callsï¼‰ï¼š</strong>æµè§ˆå™¨ä¼šç”Ÿæˆä¸€ç³»åˆ—ç»˜åˆ¶æŒ‡ä»¤ï¼ˆå¦‚"ç”»ä¸€ä¸ªçº¢è‰²çŸ©å½¢"ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥æ“ä½œåƒç´ ã€‚
                    </div>
                `,
        },
        composite: {
          title: "Composite (åˆæˆ)",
          content: `
                    <p>Composite æ˜¯æœ€åä¸€æ­¥ã€‚ç°ä»£æµè§ˆå™¨å°†é¡µé¢æ‹†åˆ†ä¸ºå¤šä¸ªå›¾å±‚ï¼ˆLayersï¼‰ï¼Œåˆ†åˆ«æ …æ ¼åŒ–ï¼Œç„¶åç”±<strong>åˆæˆçº¿ç¨‹</strong>ï¼ˆCompositor Threadï¼‰åœ¨ GPU ä¸Šå°†å®ƒä»¬åˆæˆåœ¨ä¸€èµ·ã€‚</p>
                    <div class="code-block">
/* è§¦å‘ç‹¬ç«‹å›¾å±‚ï¼š */<br>
- transform: translateZ(0)<br>
- will-change: transform<br>
- video, canvas, iframe<br>
- position: fixed
                    </div>
                    <div class="highlight-box success">
                        <strong>ğŸš€ æ€§èƒ½æ ¸å¿ƒï¼š</strong>åˆæˆæ“ä½œåœ¨ GPU ä¸Šè¿›è¡Œï¼Œä¸å ç”¨ä¸»çº¿ç¨‹ã€‚æ»šåŠ¨å’Œ transform åŠ¨ç”»å¦‚æœåªè§¦å‘åˆæˆï¼Œå°±èƒ½ä¿è¯æé«˜çš„æµç•…åº¦ï¼ˆ60fps+ï¼‰ï¼Œå³ä½¿ä¸»çº¿ç¨‹è¢« JS é˜»å¡ã€‚
                    </div>
                    <p><strong>åˆ†å—ï¼ˆTilingï¼‰ï¼š</strong>ä¸ºäº†èŠ‚çœå†…å­˜ï¼Œå¤§çš„å›¾å±‚ä¼šè¢«åˆ‡åˆ†æˆå°å—ï¼ˆTilesï¼‰è¿›è¡Œæ …æ ¼åŒ–ã€‚</p>
                `,
        },
      };

      function showStepDetail(step) {
        const detail = stepDetails[step];
        const detailEl = document.getElementById("stepDetail");
        const titleEl = document.getElementById("stepTitle");
        const contentEl = document.getElementById("stepContent");

        titleEl.textContent = detail.title;
        contentEl.innerHTML = detail.content;
        detailEl.style.display = "block";
        detailEl.scrollIntoView({ behavior: "smooth", block: "nearest" });

        addLog(`æŸ¥çœ‹è¯¦æƒ…: ${detail.title}`, "info");
      }

      // æ¼”ç¤ºå‡½æ•°
      const demoBox = document.getElementById("demoBox");

      function triggerReflow() {
        const start = performance.now();

        // è§¦å‘ Reflowï¼šæ”¹å˜å°ºå¯¸
        const currentWidth = demoBox.offsetWidth;
        demoBox.style.width = currentWidth + 50 + "px";

        // å¼ºåˆ¶åŒæ­¥ Layout
        const newWidth = demoBox.offsetWidth;

        const duration = (performance.now() - start).toFixed(2);

        addLog(
          `âš ï¸ Reflow: æ”¹å˜ width ä» ${currentWidth}px åˆ° ${newWidth}px | è€—æ—¶: ${duration}ms`,
          "reflow"
        );
        console.log(
          `%c[Reflow] è§¦å‘å¸ƒå±€é‡æ’ - è€—æ—¶: ${duration}ms`,
          "color: #fc8181; font-weight: bold"
        );

        // æ¢å¤
        setTimeout(() => {
          demoBox.style.width = "200px";
        }, 1000);
      }

      function triggerRepaint() {
        const start = performance.now();

        // è§¦å‘ Repaintï¼šæ”¹å˜é¢œè‰²
        const colors = [
          "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",
          "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",
          "linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",
          "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
        ];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        demoBox.style.background = randomColor;

        const duration = (performance.now() - start).toFixed(2);

        addLog(`ğŸ¨ Repaint: æ”¹å˜èƒŒæ™¯é¢œè‰² | è€—æ—¶: ${duration}ms`, "repaint");
        console.log(
          `%c[Repaint] è§¦å‘é‡ç»˜ - è€—æ—¶: ${duration}ms`,
          "color: #4299e1; font-weight: bold"
        );
      }

      function triggerComposite() {
        const start = performance.now();

        // è§¦å‘ Compositeï¼šä½¿ç”¨ transform
        demoBox.style.transform = "translateX(100px) rotate(10deg) scale(1.1)";

        const duration = (performance.now() - start).toFixed(2);

        addLog(
          `âœ… Composite: transform å˜æ¢ | è€—æ—¶: ${duration}ms (æœ€ä¼˜æ€§èƒ½!)`,
          "composite"
        );
        console.log(
          `%c[Composite] ä»…åˆæˆ - è€—æ—¶: ${duration}ms`,
          "color: #48bb78; font-weight: bold"
        );

        // æ¢å¤
        setTimeout(() => {
          demoBox.style.transform = "none";
        }, 1000);
      }

      function clearLogs() {
        const monitor = document.getElementById("performanceMonitor");
        monitor.innerHTML =
          '<div class="log-entry"><span class="log-time">[ç³»ç»Ÿ]</span> æ—¥å¿—å·²æ¸…ç©º</div>';
      }

      // é¡µé¢åŠ è½½æ€§èƒ½ç›‘æµ‹
      window.addEventListener("load", () => {
        const perfData = performance.timing;
        const domParse = perfData.domInteractive - perfData.domLoading;
        const pageLoad = perfData.loadEventEnd - perfData.navigationStart;

        console.group("ğŸ“Š é¡µé¢æ€§èƒ½æŒ‡æ ‡");
        console.log(`DOM è§£æè€—æ—¶: ${domParse}ms`);
        console.log(`é¡µé¢åŠ è½½è€—æ—¶: ${pageLoad}ms`);
        console.log(
          `DOMContentLoaded: ${
            perfData.domContentLoadedEventEnd - perfData.navigationStart
          }ms`
        );
        console.groupEnd();

        addLog(`é¡µé¢åŠ è½½å®Œæˆ | DOMè§£æ: ${domParse}ms | æ€»è€—æ—¶: ${pageLoad}ms`);
      });

      // ç›‘æµ‹é•¿ä»»åŠ¡
      if ("PerformanceObserver" in window) {
        try {
          const observer = new PerformanceObserver((list) => {
            for (const entry of list.getEntries()) {
              console.warn(`âš ï¸ é•¿ä»»åŠ¡æ£€æµ‹: ${entry.duration.toFixed(2)}ms`);
              addLog(
                `âš ï¸ é•¿ä»»åŠ¡: ${entry.duration.toFixed(2)}ms (>50ms ä¼šå¯¼è‡´å¡é¡¿)`,
                "reflow"
              );
            }
          });
          observer.observe({ entryTypes: ["longtask"] });
        } catch (e) {
          console.log("æ­¤æµè§ˆå™¨ä¸æ”¯æŒé•¿ä»»åŠ¡ç›‘æµ‹");
        }
      }

      console.log(
        "%cğŸš€ æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶æ¼”ç¤ºé¡µé¢",
        "font-size: 24px; color: #667eea; font-weight: bold;"
      );
      console.log(
        "%cæ‰“å¼€ Chrome DevToolsï¼š",
        "font-size: 16px; color: #764ba2;"
      );
      console.log("1. Performance é¢æ¿ â†’ å½•åˆ¶æ€§èƒ½");
      console.log("2. Rendering é¢æ¿ â†’ å¯ç”¨ Paint Flashing");
      console.log("3. Layers é¢æ¿ â†’ æŸ¥çœ‹åˆæˆå›¾å±‚");
      console.log("4. ç‚¹å‡»é¡µé¢æŒ‰é’®è§‚å¯Ÿä¸åŒæ“ä½œçš„æ€§èƒ½å·®å¼‚");
    </script>
  </body>
</html>
