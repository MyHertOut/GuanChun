<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSS åº•å±‚åŸç†äº¤äº’å¼æ¼”ç¤º</title>
    <link rel="stylesheet" href="index.css" />
    <style>
      /* é¢å¤–çš„åŠ¨ç”»å’Œäº¤äº’æ ·å¼ */
      .fade-in {
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="css-fundamentals-demo">
      <h1>ğŸ¨ CSS åº•å±‚åŸç†äº¤äº’å¼æ¼”ç¤º</h1>

      <nav class="tab-nav">
        <button class="tab-button active" data-tab="selector">
          ğŸ¯ é€‰æ‹©å™¨å¼•æ“
        </button>
        <button class="tab-button" data-tab="box">ğŸ“¦ ç›’æ¨¡å‹</button>
        <button class="tab-button" data-tab="bfc">ğŸ”² BFC</button>
        <button class="tab-button" data-tab="stacking">ğŸ“š å±‚å ä¸Šä¸‹æ–‡</button>
        <button class="tab-button" data-tab="performance">âš¡ æ€§èƒ½ä¼˜åŒ–</button>
        <button class="tab-button" data-tab="specificity">âš–ï¸ ä¼˜å…ˆçº§</button>
        <button class="tab-button" data-tab="values">ğŸ”¢ å€¼è®¡ç®—</button>
      </nav>

      <!-- Tab 1: é€‰æ‹©å™¨å¼•æ“æ¼”ç¤º -->
      <div class="demo-section" id="tab-selector">
        <h2>1. CSS é€‰æ‹©å™¨å¼•æ“ï¼šä»å³åˆ°å·¦åŒ¹é…</h2>

        <div class="demo-container">
          <div class="explanation">
            <h3>ä¸ºä»€ä¹ˆä»å³åˆ°å·¦ï¼Ÿ</h3>
            <p>
              æµè§ˆå™¨ä»å³åˆ°å·¦åŒ¹é…é€‰æ‹©å™¨å¯ä»¥å¿«é€Ÿæ’é™¤ä¸åŒ¹é…çš„èŠ‚ç‚¹ï¼Œå‡å°‘éå†æ¬¡æ•°ã€‚
            </p>
          </div>

          <div class="selector-demo">
            <div class="selector-input">
              <label>CSS é€‰æ‹©å™¨ï¼š</label>
              <input
                type="text"
                id="selectorInput"
                placeholder="ä¾‹å¦‚: .container p .text"
                value=".container p .text"
              />
            </div>

            <div class="matching-steps">
              <h4>åŒ¹é…æ­¥éª¤ï¼š</h4>
              <div id="matchingStepsContainer">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
              </div>
            </div>

            <div class="dom-tree">
              <h4>DOM æ ‘ï¼š</h4>
              <div class="tree">
                <div class="node">
                  &lt;div class="container"&gt;
                  <div class="node child">
                    &lt;p&gt;
                    <div class="node child" id="textNode">
                      &lt;span class="text"&gt;Hello&lt;/span&gt;
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="performance-comparison">
            <h4>æ€§èƒ½å¯¹æ¯”ï¼š</h4>
            <div class="comparison-grid">
              <div class="comparison-item good">
                <div class="label">âœ… å¿«é€Ÿ</div>
                <code>.text</code>
                <div class="complexity">O(n)</div>
              </div>
              <div class="comparison-item medium">
                <div class="label">âš¡ ä¸­ç­‰</div>
                <code>p .text</code>
                <div class="complexity">O(nÂ²)</div>
              </div>
              <div class="comparison-item bad">
                <div class="label">âŒ æ…¢</div>
                <code>div div div .text</code>
                <div class="complexity">O(nÂ³)</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 2: ç›’æ¨¡å‹æ¼”ç¤º -->
      <div class="demo-section" id="tab-box" style="display: none">
        <h2>2. ç›’æ¨¡å‹å¯è§†åŒ–</h2>

        <div class="demo-container">
          <div class="box-controls">
            <label>
              <input
                type="radio"
                name="boxSizing"
                value="content-box"
                checked
              />
              content-box (æ ‡å‡†ç›’æ¨¡å‹)
            </label>
            <label>
              <input type="radio" name="boxSizing" value="border-box" />
              border-box (IE ç›’æ¨¡å‹)
            </label>
          </div>

          <div class="box-settings">
            <div class="setting">
              <label>Width: <span id="widthValue">200</span>px</label>
              <input
                type="range"
                id="widthSlider"
                min="100"
                max="400"
                value="200"
              />
            </div>
            <div class="setting">
              <label>Padding: <span id="paddingValue">20</span>px</label>
              <input
                type="range"
                id="paddingSlider"
                min="0"
                max="50"
                value="20"
              />
            </div>
            <div class="setting">
              <label>Border: <span id="borderValue">5</span>px</label>
              <input
                type="range"
                id="borderSlider"
                min="0"
                max="20"
                value="5"
              />
            </div>
            <div class="setting">
              <label>Margin: <span id="marginValue">10</span>px</label>
              <input
                type="range"
                id="marginSlider"
                min="0"
                max="50"
                value="10"
              />
            </div>
          </div>

          <div class="box-visualization">
            <div class="margin-box" id="marginBox">
              <div class="margin-label">
                Margin: <span id="marginLabel">10</span>px
              </div>
              <div class="border-box" id="borderBox">
                <div class="border-label">
                  Border: <span id="borderLabel">5</span>px
                </div>
                <div class="padding-box" id="paddingBox">
                  <div class="padding-label">
                    Padding: <span id="paddingLabel">20</span>px
                  </div>
                  <div class="content-box" id="contentBox">
                    <div class="content-label">
                      Content<br />
                      <span id="contentDimensions">200px Ã— 100px</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="box-calculation">
            <h4>å°ºå¯¸è®¡ç®—ï¼š</h4>
            <div class="calc-result" id="calcResult">
              <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: BFC æ¼”ç¤º -->
      <div class="demo-section" id="tab-bfc" style="display: none">
        <h2>3. BFC (Block Formatting Context)</h2>

        <div class="demo-container">
          <div class="explanation">
            <h3>ä»€ä¹ˆæ˜¯ BFCï¼Ÿ</h3>
            <p>
              BFC
              æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œå†…éƒ¨å…ƒç´ çš„å¸ƒå±€ä¸ä¼šå½±å“å¤–éƒ¨ï¼Œå¤–éƒ¨ä¹Ÿä¸ä¼šå½±å“å†…éƒ¨ã€‚
            </p>
          </div>

          <div class="bfc-demo">
            <h4>é—®é¢˜ï¼šæµ®åŠ¨å…ƒç´ å¯¼è‡´é«˜åº¦å¡Œé™·</h4>
            <div class="demo-comparison">
              <div class="demo-case">
                <label>âŒ æ²¡æœ‰ BFC (é«˜åº¦å¡Œé™·)</label>
                <div class="container-no-bfc">
                  <div class="float-child">æµ®åŠ¨å…ƒç´ </div>
                  <div class="float-child">æµ®åŠ¨å…ƒç´ </div>
                </div>
                <div class="height-info">çˆ¶å…ƒç´ é«˜åº¦: 0px</div>
              </div>

              <div class="demo-case">
                <label>
                  âœ… åˆ›å»º BFC
                  <select id="bfcMethodSelect">
                    <option value="overflow">overflow: hidden</option>
                    <option value="display">display: flow-root</option>
                    <option value="float">float: left</option>
                  </select>
                </label>
                <div class="container-with-bfc overflow" id="bfcContainer">
                  <div class="float-child">æµ®åŠ¨å…ƒç´ </div>
                  <div class="float-child">æµ®åŠ¨å…ƒç´ </div>
                </div>
                <div class="height-info">çˆ¶å…ƒç´ é«˜åº¦: è‡ªåŠ¨åŒ…å«æµ®åŠ¨</div>
              </div>
            </div>
          </div>

          <div class="bfc-features">
            <h4>BFC çš„ç‰¹æ€§ï¼š</h4>
            <ul>
              <li>âœ… é˜»æ­¢å¤–è¾¹è·æŠ˜å </li>
              <li>âœ… åŒ…å«æµ®åŠ¨å…ƒç´ (è§£å†³é«˜åº¦å¡Œé™·)</li>
              <li>âœ… é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–</li>
            </ul>
          </div>

          <div class="bfc-triggers">
            <h4>è§¦å‘ BFC çš„æ–¹æ³•ï¼š</h4>
            <div class="trigger-list">
              <code>overflow: hidden/auto/scroll</code>
              <code>display: flow-root/flex/grid</code>
              <code>position: absolute/fixed</code>
              <code>float: left/right</code>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 4: å±‚å ä¸Šä¸‹æ–‡ -->
      <div class="demo-section" id="tab-stacking" style="display: none">
        <h2>4. å±‚å ä¸Šä¸‹æ–‡ (Stacking Context)</h2>

        <div class="demo-container">
          <div class="stacking-demo">
            <h4>å±‚å é¡ºåºå¯è§†åŒ–ï¼š</h4>
            <div class="stacking-container">
              <div class="layer" style="z-index: -1; background-color: #fecaca">
                z-index: -1
              </div>
              <div class="layer" style="z-index: 0; background-color: #fed7aa">
                z-index: 0 (default)
              </div>
              <div class="layer" style="z-index: 1; background-color: #fef08a">
                z-index: 1
              </div>
              <div class="layer" style="z-index: 10; background-color: #bbf7d0">
                z-index: 10
              </div>
              <div
                class="layer"
                style="z-index: 100; background-color: #bfdbfe"
              >
                z-index: 100
              </div>
            </div>
          </div>

          <div class="stacking-order">
            <h4>å±‚å é¡ºåº (ä»ä½åˆ°é«˜)ï¼š</h4>
            <ol class="order-list">
              <li>1. å±‚å ä¸Šä¸‹æ–‡çš„ background/border</li>
              <li>2. z-index &lt; 0 çš„å­å±‚å ä¸Šä¸‹æ–‡</li>
              <li>3. å—çº§ç›’å­</li>
              <li>4. æµ®åŠ¨ç›’å­</li>
              <li>5. è¡Œå†…ç›’å­</li>
              <li>6. z-index: 0 / auto</li>
              <li>7. z-index &gt; 0 çš„å­å±‚å ä¸Šä¸‹æ–‡</li>
            </ol>
          </div>

          <div class="stacking-trap">
            <h4>âš ï¸ å¸¸è§é™·é˜±ï¼štransform åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡</h4>
            <div class="trap-demo">
              <div class="parent-context">
                Parent (transform: translateZ(0))
                <div class="child-high-z">
                  Child (z-index: 9999)
                  <div class="note">z-index åªåœ¨çˆ¶å…ƒç´ å±‚å ä¸Šä¸‹æ–‡å†…æœ‰æ•ˆï¼</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 5: æ€§èƒ½ä¼˜åŒ– -->
      <div class="demo-section" id="tab-performance" style="display: none">
        <h2>5. CSS æ€§èƒ½ä¼˜åŒ–</h2>

        <div class="demo-container">
          <div class="performance-comparison-grid">
            <div class="perf-card bad">
              <h4>âŒ è§¦å‘ Reflow (æ…¢)</h4>
              <div class="code-block">
                .box { width: 100px; height: 100px; margin: 10px; }
              </div>
              <div class="impact">å½±å“: Layout â†’ Paint â†’ Composite</div>
            </div>

            <div class="perf-card medium">
              <h4>âš¡ è§¦å‘ Repaint (ä¸­)</h4>
              <div class="code-block">
                .box { color: red; background: blue; }
              </div>
              <div class="impact">å½±å“: Paint â†’ Composite</div>
            </div>

            <div class="perf-card good">
              <h4>âœ… åªè§¦å‘ Composite (å¿«)</h4>
              <div class="code-block">
                .box { transform: scale(1.5); opacity: 0.8; }
              </div>
              <div class="impact">å½±å“: Composite (GPU)</div>
            </div>
          </div>

          <div class="optimization-tips">
            <h4>ä¼˜åŒ–å»ºè®®ï¼š</h4>
            <ul>
              <li>âœ… ä¼˜å…ˆä½¿ç”¨ transform å’Œ opacity åšåŠ¨ç”»</li>
              <li>âœ… ä½¿ç”¨ will-change æç¤ºæµè§ˆå™¨</li>
              <li>âœ… ä½¿ç”¨ content-visibility è·³è¿‡å±å¹•å¤–å…ƒç´ æ¸²æŸ“</li>
              <li>âœ… å‡å°‘é€‰æ‹©å™¨æ·±åº¦</li>
              <li>âœ… é¿å…é€šé…ç¬¦é€‰æ‹©å™¨</li>
            </ul>
          </div>

          <div class="live-demo-performance">
            <button class="demo-btn bad" onclick="triggerReflow()">
              è§¦å‘ Reflow
            </button>
            <button class="demo-btn medium" onclick="triggerRepaint()">
              è§¦å‘ Repaint
            </button>
            <button class="demo-btn good" onclick="triggerComposite()">
              è§¦å‘ Composite
            </button>

            <div class="perf-box" id="perfBox">æ€§èƒ½æµ‹è¯•ç›’å­</div>

            <div
              class="perf-result"
              id="perfResult"
              style="display: none"
            ></div>
          </div>
        </div>
      </div>
    </div>

      <!-- Tab 6: ä¼˜å…ˆçº§æ¼”ç¤º -->
      <div class="demo-section" id="tab-specificity" style="display: none">
        <h2>6. å±‚å ä¸ä¼˜å…ˆçº§ (Cascade & Specificity)</h2>
        <div class="demo-container">
          <div class="explanation">
            <h3>è°è¯´äº†ç®—ï¼Ÿ</h3>
            <p>å½“å¤šä¸ªè§„åˆ™åº”ç”¨åˆ°åŒä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæµè§ˆå™¨é€šè¿‡<b>ç‰¹å¼‚æ€§ (Specificity)</b> æ¥å†³å®šä½¿ç”¨å“ªä¸ªæ ·å¼ã€‚</p>
          </div>

          <div class="specificity-demo">
            <div class="battle-arena">
              <div class="contestant">
                <h4>é€‰æ‹©å™¨ A</h4>
                <input type="text" id="specInputA" value="#nav .list li" placeholder="è¾“å…¥é€‰æ‹©å™¨...">
                <div class="spec-score" id="specScoreA">(0, 1, 1, 1)</div>
              </div>
              <div class="vs">VS</div>
              <div class="contestant">
                <h4>é€‰æ‹©å™¨ B</h4>
                <input type="text" id="specInputB" value="div ul li a" placeholder="è¾“å…¥é€‰æ‹©å™¨...">
                <div class="spec-score" id="specScoreB">(0, 0, 0, 4)</div>
              </div>
            </div>
            
            <div class="winner-display" id="specWinner">
              ğŸ† èƒœè€…ï¼šé€‰æ‹©å™¨ A
            </div>

            <div class="spec-rules">
              <h4>è®¡ç®—è§„åˆ™ (ID, ç±», æ ‡ç­¾)</h4>
              <ul>
                <li><span class="badge id">ID</span> = 100 åˆ†</li>
                <li><span class="badge class">ç±»/å±æ€§/ä¼ªç±»</span> = 10 åˆ†</li>
                <li><span class="badge tag">æ ‡ç­¾/ä¼ªå…ƒç´ </span> = 1 åˆ†</li>
                <li><span class="badge inline">å†…è”æ ·å¼</span> = 1000 åˆ†</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 7: å€¼è®¡ç®—æ¼”ç¤º -->
      <div class="demo-section" id="tab-values" style="display: none">
        <h2>7. CSS å€¼çš„è®¡ç®—è¿‡ç¨‹</h2>
        <div class="demo-container">
          <div class="explanation">
            <h3>ä» CSS ä»£ç åˆ°åƒç´ å€¼</h3>
            <p>æµè§ˆå™¨éœ€è¦ç»è¿‡ 6 ä¸ªæ­¥éª¤å°† CSS å€¼è½¬æ¢ä¸ºæœ€ç»ˆçš„åƒç´ å€¼ã€‚</p>
          </div>

          <div class="value-pipeline-demo">
            <div class="pipeline-controls">
              <label>çˆ¶å…ƒç´ å­—ä½“å¤§å°: <input type="range" id="parentFontSlider" min="10" max="30" value="16"> <span id="parentFontVal">16px</span></label>
              <label>å­å…ƒç´ å®½åº¦è®¾ç½®: <select id="childWidthSelect">
                <option value="50%">50%</option>
                <option value="200px">200px</option>
                <option value="auto">auto</option>
              </select></label>
            </div>

            <div class="pipeline-steps">
              <div class="p-step">
                <div class="p-title">1. Declared</div>
                <div class="p-desc">å£°æ˜å€¼</div>
                <div class="p-val" id="valDeclared">50%</div>
              </div>
              <div class="p-arrow">â†’</div>
              <div class="p-step">
                <div class="p-title">2. Cascaded</div>
                <div class="p-desc">å±‚å å€¼</div>
                <div class="p-val" id="valCascaded">50%</div>
              </div>
              <div class="p-arrow">â†’</div>
              <div class="p-step">
                <div class="p-title">3. Specified</div>
                <div class="p-desc">æŒ‡å®šå€¼</div>
                <div class="p-val" id="valSpecified">50%</div>
              </div>
              <div class="p-arrow">â†’</div>
              <div class="p-step">
                <div class="p-title">4. Computed</div>
                <div class="p-desc">è®¡ç®—å€¼</div>
                <div class="p-val" id="valComputed">50%</div>
              </div>
              <div class="p-arrow">â†’</div>
              <div class="p-step highlight">
                <div class="p-title">5. Used</div>
                <div class="p-desc">ä½¿ç”¨å€¼</div>
                <div class="p-val" id="valUsed">400px</div>
              </div>
              <div class="p-arrow">â†’</div>
              <div class="p-step">
                <div class="p-title">6. Actual</div>
                <div class="p-desc">å®é™…å€¼</div>
                <div class="p-val" id="valActual">400px</div>
              </div>
            </div>
            
            <div class="pipeline-visual">
              <div class="p-parent" id="pParent" style="width: 800px; font-size: 16px;">
                Parent (Width: 800px)
                <div class="p-child" id="pChild" style="width: 50%;">Child</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <script>
      // Tab åˆ‡æ¢åŠŸèƒ½
      const tabs = document.querySelectorAll(".tab-button");
      const sections = document.querySelectorAll(".demo-section");

      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          const targetTab = tab.dataset.tab;

          // æ›´æ–°æŒ‰é’®çŠ¶æ€
          tabs.forEach((t) => t.classList.remove("active"));
          tab.classList.add("active");

          // æ˜¾ç¤ºå¯¹åº”çš„ section
          sections.forEach((section) => {
            if (section.id === `tab-${targetTab}`) {
              section.style.display = "block";
              section.classList.add("fade-in");
            } else {
              section.style.display = "none";
            }
          });
        });
      });

      // ========== é€‰æ‹©å™¨æ¼”ç¤º ==========
      function updateMatchingSteps() {
        const selector = document.getElementById("selectorInput").value.trim();
        const container = document.getElementById("matchingStepsContainer");
        const textNode = document.getElementById("textNode");

        if (!selector) {
          container.innerHTML =
            '<div style="color: #a0aec0;">è¯·è¾“å…¥é€‰æ‹©å™¨...</div>';
          textNode.classList.remove("highlight");
          return;
        }

        const parts = selector.split(" ").reverse();
        let html = "";

        parts.forEach((part, index) => {
          if (index === 0) {
            html += `
            <div class="step">
              <div class="step-number">${index + 1}</div>
              <div class="step-content">æ‰¾åˆ°æ‰€æœ‰ '${part}' å…ƒç´ </div>
            </div>
          `;
          } else {
            html += `
            <div class="step">
              <div class="step-number">${index + 1}</div>
              <div class="step-content">æ£€æŸ¥çˆ¶å…ƒç´ æ˜¯å¦åŒ¹é… '${part}'</div>
            </div>
          `;
          }
        });

        container.innerHTML = html;

        // é«˜äº®åŒ¹é…çš„èŠ‚ç‚¹
        if (selector.includes(".text")) {
          textNode.classList.add("highlight");
        } else {
          textNode.classList.remove("highlight");
        }
      }

      document
        .getElementById("selectorInput")
        .addEventListener("input", updateMatchingSteps);
      updateMatchingSteps(); // åˆå§‹åŒ–

      // ========== ç›’æ¨¡å‹æ¼”ç¤º ==========
      const boxState = {
        boxSizing: "content-box",
        width: 200,
        padding: 20,
        border: 5,
        margin: 10,
      };

      function updateBoxModel() {
        const { boxSizing, width, padding, border, margin } = boxState;

        // æ›´æ–°å¯è§†åŒ–
        document.getElementById("marginBox").style.padding = `${margin}px`;
        document.getElementById(
          "borderBox"
        ).style.border = `${border}px solid #f59e0b`;
        document.getElementById("paddingBox").style.padding = `${padding}px`;

        const contentBox = document.getElementById("contentBox");
        if (boxSizing === "content-box") {
          contentBox.style.width = `${width}px`;
        } else {
          const contentWidth = width - padding * 2 - border * 2;
          contentBox.style.width = `${contentWidth}px`;
        }

        // æ›´æ–°æ ‡ç­¾
        document.getElementById("marginLabel").textContent = margin;
        document.getElementById("borderLabel").textContent = border;
        document.getElementById("paddingLabel").textContent = padding;

        const contentWidth =
          boxSizing === "content-box"
            ? width
            : width - padding * 2 - border * 2;
        document.getElementById(
          "contentDimensions"
        ).textContent = `${contentWidth}px Ã— 100px`;

        // æ›´æ–°è®¡ç®—ç»“æœ
        const totalWidth =
          boxSizing === "content-box"
            ? width + padding * 2 + border * 2 + margin * 2
            : width + margin * 2;

        let calcHtml = `<div><strong>è®¾ç½®çš„ width:</strong> ${width}px</div>`;

        if (boxSizing === "content-box") {
          calcHtml += `
          <div>
            <strong>å®é™…å ç”¨å®½åº¦:</strong> 
            ${width} + ${padding} Ã— 2 + ${border} Ã— 2 + ${margin} Ã— 2 
            = <strong>${totalWidth}px</strong>
          </div>
        `;
        } else {
          calcHtml += `
          <div>
            <strong>å®é™…å ç”¨å®½åº¦:</strong> 
            ${width} + ${margin} Ã— 2 
            = <strong>${totalWidth}px</strong>
            <br>
            <strong>å†…å®¹åŒºå®½åº¦:</strong> 
            ${width} - ${padding} Ã— 2 - ${border} Ã— 2 
            = <strong>${contentWidth}px</strong>
          </div>
        `;
        }

        document.getElementById("calcResult").innerHTML = calcHtml;
      }

      // ç›‘å¬ç›’æ¨¡å‹è®¾ç½®å˜åŒ–
      document.querySelectorAll('input[name="boxSizing"]').forEach((radio) => {
        radio.addEventListener("change", (e) => {
          boxState.boxSizing = e.target.value;
          updateBoxModel();
        });
      });

      const sliders = [
        { id: "widthSlider", valueId: "widthValue", key: "width" },
        { id: "paddingSlider", valueId: "paddingValue", key: "padding" },
        { id: "borderSlider", valueId: "borderValue", key: "border" },
        { id: "marginSlider", valueId: "marginValue", key: "margin" },
      ];

      sliders.forEach(({ id, valueId, key }) => {
        const slider = document.getElementById(id);
        const valueDisplay = document.getElementById(valueId);

        slider.addEventListener("input", (e) => {
          const value = parseInt(e.target.value);
          boxState[key] = value;
          valueDisplay.textContent = value;
          updateBoxModel();
        });
      });

      updateBoxModel(); // åˆå§‹åŒ–

      // ========== BFC æ¼”ç¤º ==========
      document
        .getElementById("bfcMethodSelect")
        .addEventListener("change", (e) => {
          const container = document.getElementById("bfcContainer");
          container.className = "container-with-bfc " + e.target.value;
        });

      // ========== æ€§èƒ½æ¼”ç¤º ==========
      function triggerReflow() {
        const start = performance.now();
        const box = document.getElementById("perfBox");
        const result = document.getElementById("perfResult");

        box.style.width = "300px";
        const width = box.offsetWidth; // å¼ºåˆ¶ reflow
        const duration = (performance.now() - start).toFixed(2);

        result.textContent = `âš ï¸ Reflow: ${duration}ms (è§¦å‘ Layout â†’ Paint â†’ Composite)`;
        result.style.display = "block";

        setTimeout(() => {
          box.style.width = "";
          result.style.display = "none";
        }, 2000);
      }

      function triggerRepaint() {
        const start = performance.now();
        const box = document.getElementById("perfBox");
        const result = document.getElementById("perfResult");

        box.style.backgroundColor = "#f59e0b";
        const duration = (performance.now() - start).toFixed(2);

        result.textContent = `ğŸ¨ Repaint: ${duration}ms (è§¦å‘ Paint â†’ Composite)`;
        result.style.display = "block";

        setTimeout(() => {
          box.style.backgroundColor = "";
          result.style.display = "none";
        }, 2000);
      }

      function triggerComposite() {
        const start = performance.now();
        const box = document.getElementById("perfBox");
        const result = document.getElementById("perfResult");

        box.style.transform = "scale(1.2)";
        const duration = (performance.now() - start).toFixed(2);

        result.textContent = `âœ… Composite: ${duration}ms (åªè§¦å‘ Compositeï¼ŒGPU åŠ é€Ÿ)`;
        result.style.display = "block";

        setTimeout(() => {
          box.style.transform = "";
          result.style.display = "none";
        }, 2000);
      }

      // ========== ä¼˜å…ˆçº§æ¼”ç¤º ==========
      function calculateSpecificity(selector) {
        if (!selector) return [0, 0, 0];
        
        // ç®€å•ä¼°ç®—ï¼šä¸å®Œç¾ï¼Œä½†è¶³ä»¥æ¼”ç¤ºåŸç†
        const ids = (selector.match(/#[a-zA-Z0-9_-]+/g) || []).length;
        const classes = (selector.match(/\.[a-zA-Z0-9_-]+/g) || []).length;
        const attribs = (selector.match(/\[.+?\]/g) || []).length;
        const pseudos = (selector.match(/:[a-zA-Z0-9_-]+/g) || []).length;
        // æ’é™¤ä¼ªç±»ä¸­çš„ :: (ä¼ªå…ƒç´ )
        const pseudoElements = (selector.match(/::[a-zA-Z0-9_-]+/g) || []).length;
        
        // æ ‡ç­¾ï¼šç®€å•å¤„ç†ï¼Œæ’é™¤ . # [ :
        // è¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºç”¨çš„è¿‘ä¼¼ç®—æ³•
        const parts = selector.split(/[\s>+~]+/);
        let tags = 0;
        parts.forEach(part => {
          if (part && !part.startsWith('.') && !part.startsWith('#') && !part.startsWith('[') && !part.startsWith(':')) {
            tags++;
          }
        });
        
        // ä¿®æ­£ä¼ªç±»è®¡æ•°ï¼ˆå‡å»ä¼ªå…ƒç´ ï¼‰
        const b = classes + attribs + (pseudos - pseudoElements);
        const c = tags + pseudoElements;
        
        return [ids, b, c];
      }

      function updateSpecificity() {
        const selA = document.getElementById('specInputA').value;
        const selB = document.getElementById('specInputB').value;
        
        const specA = calculateSpecificity(selA);
        const specB = calculateSpecificity(selB);
        
        document.getElementById('specScoreA').textContent = `(${specA.join(', ')})`;
        document.getElementById('specScoreB').textContent = `(${specB.join(', ')})`;
        
        // æ¯”è¾ƒ
        let winner = 'å¹³å±€';
        let winnerId = '';
        
        // æ¯”è¾ƒé€»è¾‘
        if (specA[0] !== specB[0]) {
            winner = specA[0] > specB[0] ? 'é€‰æ‹©å™¨ A' : 'é€‰æ‹©å™¨ B';
            winnerId = specA[0] > specB[0] ? 'A' : 'B';
        } else if (specA[1] !== specB[1]) {
            winner = specA[1] > specB[1] ? 'é€‰æ‹©å™¨ A' : 'é€‰æ‹©å™¨ B';
            winnerId = specA[1] > specB[1] ? 'A' : 'B';
        } else if (specA[2] !== specB[2]) {
            winner = specA[2] > specB[2] ? 'é€‰æ‹©å™¨ A' : 'é€‰æ‹©å™¨ B';
            winnerId = specA[2] > specB[2] ? 'A' : 'B';
        }
        
        const winnerEl = document.getElementById('specWinner');
        winnerEl.textContent = `ğŸ† èƒœè€…ï¼š${winner}`;
        
        if (winnerId === 'A') {
          winnerEl.className = 'winner-display win-a';
        } else if (winnerId === 'B') {
          winnerEl.className = 'winner-display win-b';
        } else {
          winnerEl.className = 'winner-display';
        }
      }
      
      document.getElementById('specInputA').addEventListener('input', updateSpecificity);
      document.getElementById('specInputB').addEventListener('input', updateSpecificity);
      updateSpecificity(); // Init

      // ========== å€¼è®¡ç®—æ¼”ç¤º ==========
      function updateValuePipeline() {
        const parentFont = parseInt(document.getElementById('parentFontSlider').value);
        const widthSetting = document.getElementById('childWidthSelect').value;
        
        document.getElementById('parentFontVal').textContent = `${parentFont}px`;
        document.getElementById('pParent').style.fontSize = `${parentFont}px`;
        
        // 1. Declared
        document.getElementById('valDeclared').textContent = widthSetting;
        
        // 2. Cascaded (å‡è®¾æ²¡æœ‰å…¶ä»–å†²çª)
        document.getElementById('valCascaded').textContent = widthSetting;
        
        // 3. Specified (å¤„ç† auto ç­‰é»˜è®¤å€¼)
        let specified = widthSetting;
        if (widthSetting === 'auto') specified = 'auto';
        document.getElementById('valSpecified').textContent = specified;
        
        // 4. Computed (ç›¸å¯¹å€¼è½¬ç»å¯¹å€¼ï¼Œä½† % åœ¨ computed é˜¶æ®µé€šå¸¸ä¿ç•™ï¼Œé™¤éæ˜¯ font-size)
        // å¯¹äº widthï¼Œcomputed value å¦‚æœæ˜¯ %ï¼Œé€šå¸¸ä¿ç•™ %ï¼Œç›´åˆ° layout é˜¶æ®µ (Used Value)
        // ä½†ä¸ºäº†æ¼”ç¤ºç®€å•ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¾ç¤º "50%" æˆ– "200px"
        document.getElementById('valComputed').textContent = specified;
        
        // 5. Used (å¸ƒå±€è®¡ç®—ï¼Œè§£æ %)
        const parentWidth = 800;
        let used = 0;
        if (widthSetting.includes('%')) {
          const percent = parseInt(widthSetting) / 100;
          used = parentWidth * percent;
        } else if (widthSetting.includes('px')) {
          used = parseInt(widthSetting);
        } else {
          // auto -> fill available (simplified)
          used = parentWidth; 
        }
        document.getElementById('valUsed').textContent = `${used}px`;
        
        // 6. Actual (å–æ•´ç­‰)
        const actual = Math.round(used); // ç®€å•æ¼”ç¤º
        document.getElementById('valActual').textContent = `${actual}px`;
        
        // Update Visual
        const child = document.getElementById('pChild');
        child.style.width = widthSetting;
        if (widthSetting === 'auto') child.style.width = '100%';
      }
      
      document.getElementById('parentFontSlider').addEventListener('input', updateValuePipeline);
      document.getElementById('childWidthSelect').addEventListener('change', updateValuePipeline);
      updateValuePipeline(); // Init

      // åˆå§‹åŒ–æç¤º
      console.log(
        "%cğŸ¨ CSS åº•å±‚åŸç†æ¼”ç¤º",
        "font-size: 24px; color: #667eea; font-weight: bold;"
      );
      console.log(
        "%cåˆ‡æ¢ä¸åŒçš„ Tab æ¥å­¦ä¹  CSS åº•å±‚æœºåˆ¶ï¼",
        "font-size: 14px; color: #764ba2;"
      );
    </script>
    <footer style="text-align: center; margin-top: 3rem; padding-bottom: 2rem; color: white; opacity: 0.8;">
      <p>æƒ³äº†è§£æ›´å¤šç†è®ºç»†èŠ‚ï¼Ÿè¯·é˜…è¯» <a href="README.md" style="color: white; text-decoration: underline;">README.md</a></p>
    </footer>
  </body>
</html>
